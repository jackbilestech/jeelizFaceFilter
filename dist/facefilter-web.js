var facefilter=function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=6)}([function(e,t,r){(function(e){window.JEEFACEFILTERAPIGEN=function(){function t(){var e=null,t=null,r=null,n=0;this.od=function(t){return e[t]},this.Nd=function(i){var a=null;n=i.length,e=i.map((function(e,t){return e=Object.assign({},e,{index:t,parent:this,Ra:a,xd:t===n-1}),a=0===t?ne.instance(e):ie.instance(e)})),t=e[0],r=e[n-1],e.forEach((function(e,t){0!==t&&e.Id()}))},this.J=function(t,r){var n=r;return e.forEach((function(e){n=e.J(n,t)})),n},this.Xb=function(){return t.B()},this.Zb=function(){return r.pd()},this.Pd=function(e){r.Zc(e)},this.Wb=function(){return r.Wb()},this.h=function(){e&&(e.forEach((function(e){e.h()})),r=t=e=null,n=0)}}var r,n,i,a,o,u,c,s,f,l,v,d,h;function m(e,t){var r=t%8;return e[(t-r)/8]>>7-r&1}function g(){return-1!==[he.play,he.pause].indexOf(me)}function p(e){if(me!==he.pause){var t=me===he.play?Ee.Ea:ve.Jc;Ie=setTimeout(y.bind(null,e),t)}}function E(){if(me===he.play)return!1;me=he.play,Oe.timestamp=Date.now(),Le&&window.cancelAnimationFrame(Le),y()}function b(){return me===he.play&&(Ie&&(clearTimeout(Ie),Ie=null),Le&&(window.cancelAnimationFrame(Le),Le=null),me=he.pause,!0)}function R(e,t,r,n,i){return e=4*(3*t+e)+r,n+(Se.buffer[e]/255+Se.buffer[e+12]/65025)*(i-n)}function T(){k.pixelStorei(k.UNPACK_FLIP_Y_WEBGL,!1),Q.V(),$.reset(),ee.reset(),Y.la(),Y.Pb(),k.disable(k.DEPTH_TEST),k.disable(k.BLEND),$.pa(),Y.za()}function y(){if(me!==he.pause){if(Y.Pb(),$.reset(),$.pa(),k.disable(k.DEPTH_TEST),k.pixelStorei(k.UNPACK_FLIP_Y_WEBGL,!1),Q.V(),Y.za(),!ge.nb)e:{if(ge.mb){if(!ge.element.needsUpdate)break e;ge.X.ae(ge.element.arrayBuffer),ge.element.needsUpdate=!1}else{var e=ge.element.currentTime,t=e-ge.Sa;if(0>t&&(ge.Sa=e),1e3*t<ve.ce)break e;ge.Sa+=t,ge.X.refresh()}Y.set("s48"),ge.Y.M(),ge.X.b(0),$.g(!1,!1)}if(Me.L.length>Oe.G)Me.L.splice(0,Me.L.length-Oe.G);else for(;Me.L.length<Oe.G;)Me.L.push(0);if(1!==Me.i)if(Ue.every(D)){for(var r=e=t=0;r<Ue.length;++r)Ue[r].detected>t&&(t=Ue[r].detected,e=0);for(t=0;t<Oe.G;++t)Me.L[t]=e}else{for(e=Me.ic,t=0,r=!1;t<Oe.G;++t){if(D(Ue[e]))if(r)do{++e===Me.i&&(e=0)}while(D(Ue[e]));else r=!0;Me.L[t]=e++,e>=Me.i&&(e=0)}Me.ic=e}for(e=0;e<Oe.G;++e)Me.ba=Me.L[e],Me.sb=(.5+Me.ba)/Me.i,Me.ec=Me.L.lastIndexOf(Me.ba)===e,Y.set("s49"),t=Ue[Me.ba],Y.A("u37",1+we.xb*(Math.cos(t.ry)-1)),Ee.ia&&Y.A("u36",t.rz),1!==Me.i&&Y.A("u35",Me.sb),De.va.M(),ge.Y.b(0),Se.Aa.b(1),$.g(!1,!1),De.va.b(0),Re.J(!1,De.va);for(e=Date.now(),Oe.sa=e-Oe.timestamp,Oe.timestamp=e,-1!==Te.nDetectsPerLoop?Oe.G=Te.nDetectsPerLoop:(e=ve.Va,Oe.lc=Oe.qb/Oe.sa,Oe.mc=Oe.lc*e+Oe.mc*(1-e),Oe.oc=1e3/Oe.sa,Oe.ja=Oe.oc*ve.Va+Oe.ja*(1-ve.Va),Oe.ja>ve.ga[1]?(e=ve.Ca[1],1<Me.i&&(++e,t=Ue.filter(F).length,e*=Math.max(1,t)),Oe.G=Math.min(Oe.G+1,e),Oe.ja=(ve.ga[0]+ve.ga[1])/2):Oe.ja<ve.ga[0]&&(Oe.G=Math.max(Oe.G-1,ve.Ca[0]),Oe.ja=(ve.ga[0]+ve.ga[1])/2)),Q.H(),k.viewport(0,0,3,2*Me.i),Y.set("s47"),Se.Aa.b(0),$.g(!1,!1),k.readPixels(0,0,3,2*Me.i,k.RGBA,k.UNSIGNED_BYTE,Se.buffer),e=0;e<Me.i;++e)if(-1!==Me.L.indexOf(e)){var n=e;t=Pe[n];var i=[n];r=Ue[n];var a=Be[n],o=2*n;if(t.Ha=R(1,o,3,0,1),r.detected=G.R(r.detected,t.Ha,ve.Gc),t.Ha<ve.pb)Ee.ia&&(r.rz=0,r.ry=0);else{var u=Se.Ba;for(t.x=R(0,o,1,-1,1),t.y=R(0,o,2,-1,1),t.U=R(0,o,3,0,1),t.vb=R(1,o,0,-u[0],u[0]),t.wb=R(1,o,1,-u[1],u[1]),t.xa=R(1,o,2,-u[2],u[2]),u=0;u<Se.S;++u)t.Rb[u]=Se.ua[u](R(2,o,u,0,1));for(i.bb=t.x-r.xRaw,i.cb=t.y-r.yRaw,i.ab=t.U-r.sRaw,i.Ya=t.vb-r.rx,i.Za=t.wb-r.ry,i.$a=Ee.ia?t.xa:t.xa-r.rz,i=(1-X.Ma(ye.translationFactorRange[0],ye.translationFactorRange[1],Math.sqrt(i.bb*i.bb+i.cb*i.cb+i.ab*i.ab)/Oe.sa))*(1-X.Ma(ye.rotationFactorRange[0],ye.rotationFactorRange[1],Math.sqrt(i.Ya*i.Ya+i.Za*i.Za+i.$a*i.$a)/Oe.sa))*X.Ma(ye.qualityFactorRange[0],ye.qualityFactorRange[1],t.Ha),n=a[++Ce[n]%a.length]=i,o=0;o<a.length;++o)n=Math.min(n,a[o]);for(n=Math.max(.5,n),i=Math.min(n,i),a=G.R(ye.alphaRange[1],ye.alphaRange[0],Math.pow(i,ve.Ic)),r.xRaw=G.R(r.xRaw,t.x,a),r.yRaw=G.R(r.yRaw,t.y,a),r.sRaw=G.R(r.sRaw,t.U,a),r.rx=G.R(r.rx,t.vb,a),r.ry=G.R(r.ry,t.wb,a),r.rz=Ee.ia?r.rz+a*t.xa:G.R(r.rz,t.xa,a),n=1*r.sRaw*we.Xa*Math.sin(r.ry),i=Math.sin(r.rz)*n/xe,r.x=r.xRaw+Math.cos(r.rz)*n,r.y=r.yRaw+i,r.s=r.sRaw,a=Math.max(a,ve.Hc),n=0;n<Se.S;++n)r.expressions[n]=G.R(r.expressions[n],t.Rb[n],a);++t.Pa}}Q.$d(),Q.reset(),ee.reset(),k.enable(k.DEPTH_TEST),Ee.Ga&&(1===Me.i?Ee.Ga(Ue[0]):Ee.Ga(Ue)),k.disable(k.BLEND),me===he.play&&(Le=window.requestAnimationFrame(p))}}function _(){ge.Y||(ge.Y=ee.instance({isPot:!1,isLinear:!0,isFloat:!1,width:De.N,height:De.P})),De.va=ee.instance({isPot:!0,isFloat:!1,width:Re.Xb()});for(var e,t=ve.wc,r=Me.i,n=new Float32Array([0,Te.borderWidth,Te.borderHeight,0,0,0,0,0,0,0,0,0]),i=new Float32Array(n.length*Me.i),a=0;a<Me.i;++a)for(e=0;e<n.length;++e)i[a*n.length+e]=n[e];Se.Aa=q.instance({width:t,height:r,isFloat:!0,isPot:!1,array:i})}function x(){Y.K("s49",[{type:"1i",name:"u1",value:0},{type:"1i",name:"u33",value:1},{type:"2f",name:"u34",value:De.u},{type:"1f",name:"u35",value:.5},{type:"1f",name:"u36",value:0}]),Y.K("s50",[{type:"1i",name:"u38",value:0},{type:"1i",name:"u33",value:1},{type:"1f",name:"u41",value:ve.Yd},{type:"1f",name:"u42",value:ve.Dc},{type:"1f",name:"u43",value:ve.Cc},{type:"3f",name:"u40",value:[Se.ea[0]*De.u[0],Se.ea[1]*De.u[1],Se.ea[2]]},{type:"1f",name:"u35",value:.5},{type:"1f",name:"u44",value:1},{type:"1f",name:"u36",value:0}]);var e=[{type:"1i",name:"u38",value:0}];Y.K("s51",e),Y.K("s52",e),Y.K("s47",[{type:"1i",name:"u33",value:0},{type:"1f",name:"u47",value:De.u[0]},{type:"2f",name:"u46",value:[0,.5/Me.i]}])}function A(){var e=Re.Xb(),t=De.N/e;u=Te.minScale*t,_e=Te.maxScale*t,c=(1-2*Te.borderWidth)/Te.nStepsX,s=(1-2*Te.borderHeight)/Te.nStepsY,f=(_e-u)/Te.nStepsScale,l=Te.borderWidth,v=Te.borderHeight,d=1-Te.borderWidth,h=1-Te.borderHeight,De.u[0]=e/De.N,De.u[1]=e/De.P,r=Te.borderWidth,n=Te.borderHeight,i=u,a=Te.borderWidth,o=Te.borderHeight,Ae=u}function w(e,t){if(e.exportData){var r=e.exportData;r.thetaXYZfactor&&(Se.Ba=r.thetaXYZfactor),r.trackingDxysFactor&&(Se.ea=r.trackingDxysFactor),void 0!==r.nExpressions&&(Se.S=r.nExpressions),we.xb=.4,we.Xa=.7,void 0!==r.fgScaleXFactor&&(we.xb=r.fgScaleXFactor),void 0!==r.fgDisplaceXFactor&&(we.Xa=r.fgDisplaceXFactor)}if(Se.S||(Se.S=ve.nc),!Se.ua)for(Se.ua=[],r=0;r<Se.S;++r)Se.ua.push(ve.jd);t(e)}function D(e){return e.detected<=ve.pb}function F(e){return e.detected>ve.pb}function S(e,t,r,n){return r>e?Math.max(0,e+t/2-(r-n/2)):Math.max(0,r+n/2-(e-t/2))}function P(){var e=Me.ba;if(Se.Aa.Rd(1),1!==Me.i&&(k.viewport(0,0,3,Me.i),Y.set("s0"),Y.vc("u1",1),$.g(!1,!1),Y.vc("u1",0)),k.viewport(0,e,1,1),Y.set("s50"),Ee.ia&&Y.A("u36",Ue[e].rz),1!==Me.i&&Y.A("u35",Me.sb),1<Me.i){var t=Pe.some((function(e,t){if(t===Me.ba)return!1;if((t=Pe[Me.ba]).Pa>e.Pa||3>e.Pa||S(t.x,t.U,e.x,e.U)<ve.jc*t.U)return!1;var r=De.N/De.P;return S(t.y,t.U*r,e.y,e.U*r)>ve.jc*t.U*r}))?0:1;Y.A("u44",t)}Y.Td("u39",a,o,Ae),$.g(!1,!1),Me.ec&&(k.viewport(1,e,1,1),Y.set("s51"),$.g(!1,!1),k.viewport(2,e,1,1),Y.set("s52"),$.g(!1,!1)),(i+=f)>_e&&(i=u,(r+=c)>d&&(r=l,(n+=s)>h&&(n=v))),a=r+.5*(Math.random()-.5)*c,o=n+.5*(Math.random()-.5)*s,Ae=i+.5*(Math.random()-.5)*f}function U(){ge.X&&ge.X.remove(),ge.mb=!!ge.element.isFakeVideo,ge.X=ee.instance(Object.assign({isPot:!1,isFloat:!1},ge.mb?{isFlipY:!1,array:ge.element.arrayBuffer,width:ge.element.videoWidth,height:ge.element.videoHeight,isKeepArray:!0}:{D:ge.element}))}function I(){Y.K("s48",[{type:"1i",name:"u1",value:0},{type:"mat2",name:"u32",value:ge.m}])}function L(){ge.C[0]=.5,ge.C[1]=.5;var e=ge.u[1]/ge.u[0];switch(xe=V.O()/V.B(),90===Math.abs(de.rotate)&&(e=1/e),e>xe?ge.C[1]*=xe/e:ge.C[0]*=e/xe,Y.K("s50",[{name:"u45",type:"1f",value:xe}]),ge.m[0]=0,ge.m[1]=0,ge.m[2]=0,ge.m[3]=0,de.rotate){case 0:ge.m[0]=ge.C[0],ge.m[3]=ge.C[1];break;case 180:ge.m[0]=-ge.C[0],ge.m[3]=-ge.C[1];break;case 90:ge.m[1]=ge.C[0],ge.m[2]=-ge.C[1];break;case-90:ge.m[1]=-ge.C[0],ge.m[2]=ge.C[1]}de.flipX&&(ge.m[0]*=-1,ge.m[2]*=-1)}function M(){var e=ge.element.videoWidth,t=ge.element.videoHeight,r=ge.u[0]!==e||ge.u[1]!==t;return r&&(ge.u[0]=e,ge.u[1]=t),r}function O(e,t){return me!==he.error&&(ge.element=e,M(),t&&t(),!0)}function B(e,t,r){e&&e(),ge.ra={video:{facingMode:{ideal:de.facingMode},width:{min:de.minWidth,max:de.maxWidth,ideal:de.idealWidth},height:{min:de.minHeight,max:de.maxHeight,ideal:de.idealHeight}},audio:!1},de.deviceId&&(ge.ra.deviceId=de.deviceId),le.get(ge.element?ge.element:le.rd(),(function(e){t&&t(e),r(e)}),(function(){C("WEBCAM_UNAVAILABLE")}),ge.ra)}function C(e){me!==he.error&&(me=he.error,Ee.qa&&Ee.qa(e))}var N,G={Xe:function(e){return Math.ceil(Math.log2(e))},Ad:function(e){return Math.log2(e)},kf:function(e){return 0==Math.log2(e)%1},le:function(e){var t=[0,0,0,0];return e.forEach((function(e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2],t[3]+=e[3]})),t},me:function(e,t,r){return Math.min(Math.max(e,t),r)},re:function(e){return e*Math.PI/180},sf:function(e,t){return t=Math.pow(10,t),Math.round(e*t)/t},tf:function(e){return Math.round(1e6*e)/1e6},Ye:function(e,t){return(100*e/t).toFixed(3)},R:function(e,t,r){return e*(1-r)+t*r},dd:function(e,t){return G.Vc(e-t)},Vc:function(e){for(;e>Math.PI;)e-=2*Math.PI;for(;e<=-Math.PI;)e+=2*Math.PI;return e},te:function(e,t){return Math.abs(G.dd(e,t))},de:function(e,t){return Math.atan2(Math.sin(e)+Math.sin(t),Math.cos(e)+Math.cos(t))}},H={get:function(e,t,r){var n=new XMLHttpRequest;n.open("GET",e,!0),n.withCredentials=!1,n.onreadystatechange=function(){4===n.readyState&&(200===n.status||0===n.status?t(n.responseText):void 0!==r&&r(n.status))},n.send()},Te:function(e,t){H.get(e,(function(e){t(JSON.parse(e))}))},qf:function(e,t,r){var n=new XMLHttpRequest;n.open("POST",e,!0),n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.onreadystatechange=function(){4!==n.readyState||200!==n.status&&0!==n.status||r(n.responseText)},n.send(t)},Ke:function(e,t){var r=new XMLHttpRequest;r.open("POST",e,!0),r.responseType="arraybuffer",r.onload=function(){t(r.response)},r.send()}},X={Ef:function(e,t,r){return(e=Math.min(Math.max((r-e)/(t-e),0),1))*e*(3-2*e)},Ma:function(e,t,r){return Math.min(Math.max((r-e)/(t-e),0),1)},Ee:function(e,t,r,n){return Math.pow(Math.min(Math.max((n-e)/(t-e),0),1),r)},If:function(){return 0},pf:function(){return 1},mf:function(e){return e},Be:function(e){return e*e},Ge:function(e){return e*(2-e)},ye:function(e){return.5>e?2*e*e:(4-2*e)*e-1},we:function(e){return e*e*e},Fe:function(e){return--e*e*e+1},xe:function(e){return.5>e?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},Ce:function(e){return e*e*e*e},He:function(e){return 1- --e*e*e*e},ze:function(e){return.5>e?8*e*e*e*e:1-8*--e*e*e*e},De:function(e){return e*e*e*e*e},Ie:function(e){return 1+--e*e*e*e*e},Ae:function(e){return.5>e?16*e*e*e*e*e:1+16*--e*e*e*e*e}},z=function(e,t,r){switch(e){case"relu":return r+"=max(vec4(0.,0.,0.,0.),"+t+");";case"elu":return r+"=mix(exp(-abs("+t+"))-vec4(1.,1.,1.,1.),"+t+",step(0.,"+t+"));";case"elu01":return r+"=mix(0.1*exp(-abs("+t+"))-vec4(0.1,0.1,0.1,0.1),"+t+",step(0.,"+t+"));";case"arctan":return r+"=atan(3.14159265359*texture2D(u0,vUV))/3.14159265359;";case"copy":return"";default:return!1}},Y=function(){function e(e,t){return e=k.createShader(e),k.shaderSource(e,t),k.compileShader(e),!!k.getShaderParameter(e,k.COMPILE_STATUS)&&e}function t(t){if(void 0===t.fa&&(t.fa="precision lowp float;attribute vec2 a0;varying vec2 vv0;void main(){gl_Position=vec4(a0,0.,1.),vv0=a0*.5+vec2(.5,.5);}"),void 0===t.Fa&&(t.Fa=["a0"]),void 0===t.na&&(t.na=[2]),void 0!==t.precision&&"highp"!==t.precision||(t.precision=u),t.id=a++,void 0!==t.Md&&t.Md.forEach((function(e,r){t.a=t.a.replace(e,t.Ta[r])})),t.Bb=0,t.na.forEach((function(e){t.Bb+=4*e})),t.wa=function(t,n){t=e(k.VERTEX_SHADER,t),n=e(k.FRAGMENT_SHADER,n),r.push(t,n);var i=k.createProgram();return k.attachShader(i,t),k.attachShader(i,n),k.linkProgram(i),i}(t.fa,"precision "+t.precision+" float;\n"+t.a),t.j={},t.c.forEach((function(e){t.j[e]=k.getUniformLocation(t.wa,e)})),t.attributes={},t.oa=[],t.Fa.forEach((function(e){var r=k.getAttribLocation(t.wa,e);t.attributes[e]=r,t.oa.push(r)})),t.f)for(var o in k.useProgram(t.wa),i=t,n=t.id,t.f)k.uniform1i(t.j[o],t.f[o]);t.kb=!0}var r=[],n=-1,i=null,a=0,o=!1,u="highp",c=["u1"],s=["u0"],f={u1:0},l={u0:0},v={u1:0,u2:1},d={u3:0},h={s0:{a:"uniform sampler2D u1;varying vec2 vv0;void main(){gl_FragColor=texture2D(u1,vv0);}",c:c,f:f},s1:{a:"uniform sampler2D u1;varying vec2 vv0;void main(){gl_FragColor=texture2D(u1,vv0);}",c:c,f:f,precision:"lowp"},s2:{a:"uniform sampler2D u1,u2;varying vec2 vv0;void main(){vec4 a=texture2D(u2,vv0),b=texture2D(u1,vv0);gl_FragColor=a*b;}",c:["u1","u2"],f:v},s3:{a:"uniform sampler2D u1;varying vec2 vv0;const vec4 f=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u1,vv0);gl_FragColor=a.r*f;}",c:c,f:f},s4:{a:"uniform sampler2D u1,u2;varying vec2 vv0;const vec4 f=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u2,vv0),b=texture2D(u1,vv0);gl_FragColor=a.a*b.r*f;}",c:["u1","u2"],f:v},s5:{a:"uniform sampler2D u1;varying vec2 vv0;void main(){gl_FragColor=texture2D(u1,vec2(1.-vv0.x,vv0.y));}",c:c,f:f},s6:{a:"uniform sampler2D u1;varying vec2 vv0;void main(){gl_FragColor=texture2D(u1,vec2(vv0.x,1.-vv0.y));}",c:c,f:f},s7:{a:"uniform sampler2D u0;uniform float u4;varying vec2 vv0;void main(){vec4 a=texture2D(u0,vv0);gl_FragColor=a*u4;}",c:["u0","u4"],f:l},s8:{a:"uniform sampler2D u0;uniform float u4;varying vec2 vv0;const vec4 f=vec4(.25,.25,.25,.25),g=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u0,vv0);float b=dot(a*u4,f);gl_FragColor=b*g;}",c:["u0","u4"],f:l},s9:{a:"uniform sampler2D u1;varying vec2 vv0;const vec4 e=vec4(1.,1.,1.,1.);void main(){float a=.25*dot(e,texture2D(u1,vv0));gl_FragColor=a*e;}",c:c,f:f},s10:{a:"uniform sampler2D u1,u5;uniform float u6;const vec4 f=vec4(1.,1.,1.,1.);varying vec2 vv0;void main(){vec4 a=texture2D(u1,vv0),b=texture2D(u5,vv0);gl_FragColor=mix(b,a,u6*f);}",c:["u1","u5","u6"],f:{u1:0,u5:1}},s11:{a:"uniform sampler2D u1;uniform vec2 u7;varying vec2 vv0;void main(){gl_FragColor=.25*(texture2D(u1,vv0+u7)+texture2D(u1,vv0+u7*vec2(1.,-1.))+texture2D(u1,vv0+u7*vec2(-1.,-1.))+texture2D(u1,vv0+u7*vec2(-1.,1.)));}",c:["u1","u7"],f:f},s12:{a:"uniform sampler2D u1;uniform vec4 u8;varying vec2 vv0;float g(float a,float b){a=floor(a)+.5;return floor(a/exp2(b));}float h(float a,float b){return floor(a*exp2(b)+.5);}float i(float a,float b){return mod(a,h(1.,b));}float e(float c,float a,float b){a=floor(a+.5),b=floor(b+.5);return i(g(c,a),b-a);}vec4 j(float a){if(a==0.)return vec4(0.,0.,0.,0.);float k=128.*step(a,0.);a=abs(a);float c=floor(log2(a)),l=c+127.,b=(a/exp2(c)-1.)*8388608.,d=l/2.,m=fract(d)*2.,n=floor(d),o=e(b,0.,8.),p=e(b,8.,16.),q=m*128.+e(b,16.,23.),r=k+n;return vec4(o,p,q,r)/255.;}void main(){float a=dot(texture2D(u1,vv0),u8);gl_FragColor=j(a);}",c:["u1","u8"],f:f},s13:{a:"uniform sampler2D u0;varying vec2 vv0;const vec4 e=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u0,vv0),b=e/(e+exp(-a));gl_FragColor=b;}",c:s,f:l},s14:{a:"uniform sampler2D u0;varying vec2 vv0;const vec4 f=vec4(0.,0.,0.,0.);void main(){vec4 a=texture2D(u0,vv0);gl_FragColor=max(f,a);}",c:s,f:l},s15:{a:"uniform sampler2D u0;varying vec2 vv0;const vec4 f=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u0,vv0);gl_FragColor=mix(exp(-abs(a))-f,a,step(0.,a));}",c:s,f:l},s16:{a:"uniform sampler2D u0;varying vec2 vv0;const vec4 f=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u0,vv0),b=exp(-abs(a))-f;gl_FragColor=mix(.1*b,a,step(0.,a));}",c:s,f:l},s17:{a:"uniform sampler2D u0,u6,u9;varying vec2 vv0;const vec4 f=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u0,vv0),c=texture2D(u6,vv0),d=texture2D(u9,vv0),b=a/d;gl_FragColor=c*mix(exp(-abs(b))-f,b,step(0.,a));}",c:["u0","u6","u9"],f:{u0:0,u6:1,u9:2}},s18:{a:"uniform sampler2D u0;const float e=3.141593;varying vec2 vv0;void main(){gl_FragColor=atan(e*texture2D(u0,vv0))/e;}",c:s,f:l},s19:{a:"uniform sampler2D u0;varying vec2 vv0;const vec4 f=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u0,vv0),b=log(f+a);gl_FragColor=b;}",c:s,f:l},s20:{a:"uniform sampler2D u0,u10;uniform float u11;const vec2 e=vec2(.5,.5);const float f=1e-5;const vec4 g=vec4(1.,1.,1.,1.),i=vec4(0.,0.,0.,0.);varying vec2 vv0;void main(){vec4 a=texture2D(u10,e);float b=u11*u11;vec4 c=max(b*a,f*g);gl_FragColor=texture2D(u0,vv0)/c;}",c:["u0","u10","u11"],f:{u0:0,u10:1}},s21:{a:"uniform sampler2D u1;uniform vec2 u12;varying vec2 vv0;void main(){float a=u12.x*u12.y;vec2 b=floor(vv0*a)/a,c=fract(vv0*a),d=floor(b*u12.y),f=floor(u12.x*fract(b*u12.y)),g=(f*u12.y+d)/a;gl_FragColor=texture2D(u1,g+c/a);}",c:["u1","u12"],f:f},s22:{a:"uniform sampler2D u13,u14,u15;varying vec2 vv0;void main(){vec4 a=texture2D(u15,vv0);vec2 b=a.rg,c=a.ba;vec4 d=texture2D(u13,b),f=texture2D(u14,c);gl_FragColor=d*f;}",c:["u13","u14","u15"],f:{u14:0,u13:1,u15:2}},s23:{a:"uniform float u16;uniform sampler2D u13,u14;varying vec2 vv0;void main(){vec2 a=fract(vv0*u16);vec4 b=texture2D(u13,vv0),c=texture2D(u14,a);gl_FragColor=b*c;}",c:["u14","u13","u16"],f:{u14:0,u13:1}},s24:{a:"uniform float u16;uniform sampler2D u13,u14,u17,u18,u19,u20;varying vec2 vv0;const vec4 e=vec4(1.,1.,1.,1.),g=vec4(1e-3,1e-3,1e-3,1e-3);void main(){vec2 h=vv0*u16,l=floor(h),c=h-l;vec4 m=texture2D(u13,vv0),d=texture2D(u14,c),a=texture2D(u20,vv0);a=a*255.;vec4 n=texture2D(u17,c),o=texture2D(u18,c),p=texture2D(u19,c),i=step(-g,-a),b=e-i,j=b*step(-e-g,-a);b*=e-j;vec4 k=b*step(-2.*e-g,-a);b*=e-k;vec4 q=b;d=i*d+j*n+k*o+q*p,gl_FragColor=m*d;}",c:"u13 u14 u16 u20 u17 u18 u19".split(" "),f:{u14:0,u13:1,u20:3,u17:4,u18:5,u19:6}},s25:{a:"uniform sampler2D u13,u14,u21;uniform float u16,u22,u23,u24;varying vec2 vv0;const vec2 j=vec2(1.,1.);void main(){vec2 a=floor(u22*vv0),b=u22*vv0-a;float c=u16/u22;vec2 d=floor(b*c),f=b*c-d,g=(a+f)/u22;float k=u22*u24/u16;vec2 l=k*d,h=(l+f*u23)/u24,i=step(h,j);vec4 m=texture2D(u13,g),n=texture2D(u14,h),o=m*n*i.x*i.y,p=texture2D(u21,g);gl_FragColor=o*u23*u23+p;}",c:"u13 u14 u16 u22 u23 u24 u21".split(" "),f:{u14:0,u13:1,u21:2}},s26:{a:"uniform sampler2D u13,u14;varying vec2 vv0;void main(){vec4 a=texture2D(u13,vv0),b=texture2D(u14,vv0);gl_FragColor=a*b;}",c:["u13","u14"],f:{u14:0,u13:1}},s27:{a:"uniform sampler2D u1,u21;uniform float u25;varying vec2 vv0;void main(){gl_FragColor=texture2D(u21,vv0)+u25*texture2D(u1,vv0);}",c:["u1","u21","u25"],f:{u1:0,u21:1}},s28:{a:"varying vec2 vv0;uniform sampler2D u1;const vec4 f=vec4(1.,1.,1.,1.),g=vec4(.299,.587,.114,0.);void main(){vec4 a=texture2D(u1,vv0);gl_FragColor=dot(a,g)*f;}",c:c,f:f,precision:"lowp"},s29:{a:"varying vec2 vv0;uniform sampler2D u1;uniform float u26;const vec3 f=vec3(.299,.587,.114);void main(){vec3 a=texture2D(u1,vv0).rgb,b=texture2D(u1,vv0+vec2(0.,u26)).rgb,c=texture2D(u1,vv0+vec2(u26,u26)).rgb,d=texture2D(u1,vv0+vec2(u26,0.)).rgb;gl_FragColor=vec4(dot(a,f),dot(b,f),dot(c,f),dot(d,f));}",c:["u1","u26"],f:f,precision:"lowp"},s30:{a:"varying vec2 vv0;uniform sampler2D u1;uniform float u26;const vec3 f=vec3(.299,.587,.114);void main(){vec3 a=texture2D(u1,vv0).rgb,b=texture2D(u1,vv0+vec2(0.,u26)).rgb,c=texture2D(u1,vv0+vec2(u26,u26)).rgb,d=texture2D(u1,vv0+vec2(u26,0.)).rgb;gl_FragColor=vec4(a.r,b.g,c.b,dot(d,f));}",c:["u1","u26"],f:f,precision:"lowp"},s31:{a:"varying vec2 vv0;uniform sampler2D u1,u2;uniform float u27;const vec4 f=vec4(1.,1.,1.,1.);void main(){vec4 a=vec4(0.);a-=texture2D(u1,vec2(vv0.x-u27,vv0.y-u27))*1.,a-=texture2D(u1,vec2(vv0.x-u27,vv0.y))*2.,a-=texture2D(u1,vec2(vv0.x-u27,vv0.y+u27))*1.,a+=texture2D(u1,vec2(vv0.x+u27,vv0.y-u27))*1.,a+=texture2D(u1,vec2(vv0.x+u27,vv0.y))*2.,a+=texture2D(u1,vec2(vv0.x+u27,vv0.y+u27))*1.;vec4 b=vec4(0.);b-=texture2D(u1,vec2(vv0.x-u27,vv0.y-u27))*1.,b-=texture2D(u1,vec2(vv0.x,vv0.y-u27))*2.,b-=texture2D(u1,vec2(vv0.x+u27,vv0.y-u27))*1.,b+=texture2D(u1,vec2(vv0.x-u27,vv0.y+u27))*1.,b+=texture2D(u1,vec2(vv0.x,vv0.y+u27))*2.,b+=texture2D(u1,vec2(vv0.x+u27,vv0.y+u27))*1.;vec3 c=sqrt(a.rgb*a.rgb+b.rgb*b.rgb);vec4 e=vec4(c,texture2D(u1,vv0).a),g=texture2D(u2,vv0);gl_FragColor=g.a*e.r*f;}",c:["u1","u2","u27"],f:v},s32:{a:"varying vec2 vv0;uniform sampler2D u1,u2;uniform float u27;const vec4 j=vec4(1.,1.,1.,1.);const vec2 k=vec2(1.,1.);void main(){float h=0.;vec2 l=k*u27,a,b;float c,d,i=0.;for(float e=-4.;e<=4.;e+=1.)for(float f=-4.;f<=4.;f+=1.)a=vec2(e,f),c=length(a)/2.,d=exp(-c*c),b=vv0+l*a,h+=d*texture2D(u1,b).r,i+=d;vec4 m=texture2D(u2,vv0);gl_FragColor=m.a*(texture2D(u1,b).r-h/i)*j;}",c:["u1","u2","u27"],f:v},s33:{a:"uniform sampler2D u3;uniform vec2 u7;varying vec2 vv0;vec4 e(vec4 a,vec4 b){vec4 c=step(a,b);return mix(a,b,c);}const vec2 g=vec2(.5,.5),h=vec2(1.,0.),i=vec2(0.,1.);void main(){vec2 a=vv0-u7*g;vec4 b=texture2D(u3,a),c=texture2D(u3,a+u7*h),d=texture2D(u3,a+u7*i),j=texture2D(u3,a+u7),k=e(b,c),l=e(d,j);gl_FragColor=e(k,l);}",c:["u3","u7"],f:d},s34:{a:"uniform sampler2D u3;uniform vec2 u7;varying vec2 vv0;const vec2 k=vec2(1.,0.),l=vec2(0.,1.),m=vec2(2.,0.),n=vec2(0.,2.);vec4 e(vec4 a,vec4 b){vec4 c=step(a,b);return mix(a,b,c);}vec4 f(vec2 a){vec4 b=texture2D(u3,a),c=texture2D(u3,a+u7*k),d=texture2D(u3,a+u7*l),g=texture2D(u3,a+u7),h=e(b,c),i=e(d,g);return e(h,i);}void main(){vec2 a=vv0+u7*vec2(-.55,-1.05);vec4 b=f(a),c=f(a+u7*m),d=f(a+u7*2.),g=f(a+u7*n),h=e(b,c),i=e(d,g);gl_FragColor=e(h,i);}",c:["u3","u7"],f:d},s35:{a:"uniform sampler2D u1;varying vec2 vv0;void main(){vec4 a=texture2D(u1,vv0);gl_FragColor=a*a;}",c:["u1"],f:f,precision:"lowp"},s36:{a:"uniform sampler2D u1;uniform vec2 u7;varying vec2 vv0;const float e=15444.;void main(){vec4 a=1001./e*texture2D(u1,vv0-3.*u7)+2002./e*texture2D(u1,vv0-2.*u7)+3003./e*texture2D(u1,vv0-u7)+3432./e*texture2D(u1,vv0)+3003./e*texture2D(u1,vv0+u7)+2002./e*texture2D(u1,vv0+2.*u7)+1001./e*texture2D(u1,vv0+3.*u7);gl_FragColor=a;}",c:["u7","u1"],f:f,precision:"lowp"},s37:{a:"uniform sampler2D u1,u28,u29;varying vec2 vv0;const vec4 f=vec4(1.,1.,1.,1.);const float g=.1;void main(){vec4 a=texture2D(u28,vv0),b=texture2D(u29,vv0),c=texture2D(u1,vv0),d=max(f*g,b-a*a),h=sqrt(d);gl_FragColor=(c-a)/h;}",c:["u1","u28","u29"],f:{u1:0,u28:1,u29:2}}},m={s38:{a:"uniform float u16,u30;uniform sampler2D u13,u14,u21;varying vec2 vv0;const vec2 ZERO2=vec2(0.,0.),ONE2=vec2(1.,1.),HALF2=vec2(.5,.5),EPS2=vec2(1e-5,1e-5);void main(){vec4 sum=texture2D(u21,vv0);float toSparsity=1.1111;vec2 uvFrom,uvWeight,xyPatch=ZERO2,eps2=EPS2/u16,xyTo=floor(vv0*u16+eps2);float weightSize=toSparsity*u16;vec2 halfFromSparsity=ONE2*(toSparsity-1.)/2.;for(float patch_x=0.;patch_x<1.1111;patch_x+=1.){xyPatch.x=patch_x;for(float patch_y=0.;patch_y<1.1111;patch_y+=1.)xyPatch.y=patch_y,uvFrom=(xyTo+HALF2+u30*(xyPatch-halfFromSparsity))/u16,uvFrom+=step(uvFrom,-eps2),uvFrom-=step(ONE2-eps2,uvFrom),uvWeight=(xyTo*toSparsity+xyPatch+HALF2)/weightSize,sum+=texture2D(u13,uvWeight)*texture2D(u14,uvFrom);}gl_FragColor=sum,gl_FragColor*=2.2222;}",c:["u16","u13","u14","u21","u30"],Ta:["1.1111","gl_FragColor\\*=2.2222;"]},s39:{a:"uniform float u16,u30,u24;uniform sampler2D u13,u14,u21;varying vec2 vv0;const vec2 ZERO2=vec2(0.,0.),ONE2=vec2(1.,1.),HALF2=vec2(.5,.5),EPS2=vec2(1e-4,1e-4);void main(){vec4 sum=texture2D(u21,vv0);float fromSparsity=1.1111,shrinkFactor=3.3333;vec2 uvFrom,uvWeight,xyFrom,xyPatchTo,xyPatch=ZERO2,xyShrink=ZERO2,eps2=EPS2/u24,xyTo=floor(vv0*u16+eps2);float weightSize=fromSparsity*u24;vec2 halfFromSparsity=ONE2*(fromSparsity-1.)/2.;float toSparsity=weightSize/u16;vec2 xyFrom0=xyTo*shrinkFactor;for(float patch_x=0.;patch_x<1.1111;patch_x+=1.){xyPatch.x=patch_x;for(float patch_y=0.;patch_y<1.1111;patch_y+=1.){xyPatch.y=patch_y;for(float shrink_x=0.;shrink_x<3.3333;shrink_x+=1.){xyShrink.x=shrink_x;for(float shrink_y=0.;shrink_y<3.3333;shrink_y+=1.)xyShrink.y=shrink_y,xyFrom=xyFrom0+xyShrink+shrinkFactor*u30*(xyPatch-halfFromSparsity),uvFrom=(xyFrom+HALF2)/u24,uvFrom+=step(uvFrom,-eps2),uvFrom-=step(ONE2-eps2,uvFrom),xyPatchTo=xyPatch*shrinkFactor+xyShrink,uvWeight=(xyTo*toSparsity+xyPatchTo+HALF2)/weightSize,sum+=texture2D(u13,uvWeight)*texture2D(u14,uvFrom);}}}gl_FragColor=sum,gl_FragColor*=2.2222;}",c:"u16 u24 u13 u14 u21 u30".split(" "),Ta:["1.1111","gl_FragColor\\*=2.2222;","3.3333"]}},g={La:function(){return o},o:function(){if(!o){for(var e in u="highp",h)t(h[e]);return Y.set("s0"),k.enableVertexAttribArray(0),o=!0,te.o()}},Fc:function(e){e.forEach((function(e){g.Eb(e)}))},Eb:function(e){h[e.id]=e,t(e,e.id)},ac:function(e,r,n){r||(r=e),h[r]=Object.create(m[e]),h[r].wd=!0,m[e].Ta&&m[e].Ta.forEach((function(e,t){h[r].a=h[r].a.replace(new RegExp(e,"g"),n[t])})),t(h[r])},set:function(e){!function(e){j.Sd(g),n!==e.id&&(g.la(),n=e.id,i=e,k.useProgram(e.wa),e.oa.forEach((function(e){0!==e&&k.enableVertexAttribArray(e)})))}(h[e])},hd:function(e){return void 0!==h[e]&&h[e].kb},la:function(){-1!==n&&(n=-1,i.oa.forEach((function(e){0!==e&&k.disableVertexAttribArray(e)})))},zb:function(){var e=0;i.oa.forEach((function(t,r){r=i.na[r],k.vertexAttribPointer(t,r,k.FLOAT,!1,i.Bb,e),e+=4*r}))},Pb:function(){k.enableVertexAttribArray(0)},za:function(){k.vertexAttribPointer(i.oa[0],2,k.FLOAT,!1,8,0)},vc:function(e,t){k.uniform1i(i.j[e],t)},A:function(e,t){k.uniform1f(i.j[e],t)},ya:function(e,t,r){k.uniform2f(i.j[e],t,r)},yf:function(e,t){k.uniform2fv(i.j[e],t)},zf:function(e,t){k.uniform3fv(i.j[e],t)},Td:function(e,t,r,n){k.uniform3f(i.j[e],t,r,n)},Af:function(e,t,r,n,a){k.uniform4f(i.j[e],t,r,n,a)},yb:function(e,t){k.uniform4fv(i.j[e],t)},Bf:function(e,t){k.uniformMatrix2fv(i.j[e],!1,t)},Cf:function(e,t){k.uniformMatrix3fv(i.j[e],!1,t)},Df:function(e,t){k.uniformMatrix4fv(i.j[e],!1,t)},K:function(e,t){g.set(e),t.forEach((function(e){switch(e.type){case"4f":k.uniform4fv(i.j[e.name],e.value);break;case"3f":k.uniform3fv(i.j[e.name],e.value);break;case"2f":k.uniform2fv(i.j[e.name],e.value);break;case"1f":k.uniform1f(i.j[e.name],e.value);break;case"1i":k.uniform1i(i.j[e.name],e.value);break;case"mat2":k.uniformMatrix2fv(i.j[e.name],!1,e.value);break;case"mat3":k.uniformMatrix3fv(i.j[e.name],!1,e.value);break;case"mat4":k.uniformMatrix4fv(i.j[e.name],!1,e.value)}}))},We:function(){return"lowp"},h:function(){for(var e in k.disableVertexAttribArray(0),g.la(),h){var t=h[e];t.kb&&(t.kb=!1,k.deleteProgram(t.wa)),t.wd&&delete h[e]}r.forEach((function(e){k.deleteShader(e)})),r.splice(0),a=0,o=!1}};return g}(),k=null,V=function(){function e(e){return console.log("ERROR in ContextFeedForward: ",e),!1}var t=null,r=null,n=null,i=null,a=!0,o=null,u=null,c={B:function(){return t.width},O:function(){return t.height},Ne:function(){return t},Me:function(){return k},F:function(){return a},flush:function(){k.flush()},nd:function(){return o||(o=new Uint8Array(t.width*t.height*4)),k.readPixels(0,0,t.width,t.height,k.RGBA,k.UNSIGNED_BYTE,o),o},Pe:function(){return t.toDataURL("image/jpeg")},Qe:function(){Q.H(),r||(r=document.createElement("canvas"),n=r.getContext("2d")),r.width=t.width,r.height=t.height;for(var e=c.nd(),i=n.createImageData(r.width,r.height),a=r.width,o=r.height,u=i.data,s=0;s<o;++s)for(var f=o-s-1,l=0;l<a;++l){var v=4*(s*a+l),d=4*(f*a+l);u[v]=e[d],u[v+1]=e[d+1],u[v+2]=e[d+2],u[v+3]=e[d+3]}return n.putImageData(i,0,0),r.toDataURL("image/png")},Oe:function(e){!r&&e&&(r=document.createElement("canvas"),n=r.getContext("2d"));var i=e?r:document.createElement("canvas");return i.width=t.width,i.height=t.height,(e?n:i.getContext("2d")).drawImage(t,0,0),i},o:function(r){if(r.$c&&!r.Wa?t=document.getElementById(r.$c):r.Wa&&(t=r.Wa),t||(t=document.createElement("canvas")),t.width=r&&void 0!==r.width?r.width:512,t.height=r&&void 0!==r.height?r.height:512,void 0===r&&(r={}),void 0===r.premultipliedAlpha&&(r.premultipliedAlpha=!1),void 0===r.dc&&(r.dc=!0),void 0===r.antialias&&(r.antialias=!1),!k){var n={antialias:r.antialias,alpha:!0,preserveDrawingBuffer:!0,premultipliedAlpha:r.premultipliedAlpha,stencil:!1,depth:r.dc};navigator&&navigator.userAgent&&-1!==navigator.userAgent.indexOf("noAntialiasing")&&(n.antialias=!1),function(){return!!(navigator.userAgent&&-1!==navigator.userAgent.indexOf("forceWebGL1")||/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream)||!(!/(Mac)/i.test(navigator.platform)||(e=!!(e=navigator.userAgent)&&(!(!(e=e.match(/Mac OS X (\d+)_(\d+)/)||e.match(/Mac OS X (\d+).(\d+)/))||3>e.length)&&[parseInt(e[1],10),parseInt(e[2],10)]),!e||10!==e[0]||15!==e[1]));var e}()||(k=t.getContext("webgl2",n)),k?a=!0:((k=t.getContext("webgl",n))||(k=t.getContext("experimental-webgl",n)),a=!1)}return k?((i=k.getExtension("WEBGL_lose_context"))&&r.pc&&(u=r.pc,t.addEventListener("webglcontextlost",u,!1)),Z.o()?!Z.Pc()&&a?e("Your configuration cannot process color buffer float"):(k.clearColor(0,0,0,0),k.disable(k.DEPTH_TEST),k.disable(k.BLEND),k.disable(k.DITHER),k.disable(k.STENCIL_TEST),k.disable(k.SCISSOR_TEST),k.GENERATE_MIPMAP_HINT&&k.hint(k.GENERATE_MIPMAP_HINT,k.FASTEST),k.disable(k.SAMPLE_ALPHA_TO_COVERAGE),k.disable(k.SAMPLE_COVERAGE),!0):e("Not enough capabilities")):e("WebGL1 and 2 are not enabled")},ud:function(){return!!Y.o()&&(k.depthFunc(k.LEQUAL),k.clearDepth(1),!0)},h:function(){k&&Z.h(),i&&u&&(t.removeEventListener("webglcontextlost",u,!1),u=null),o=n=r=t=null}};return c}(),j=(N=void 0===Y?null:Y,{Sd:function(e){N!==e&&(N&&N.la(),N=e)},La:function(){return N.La()},za:function(){N.za()},zb:function(){N.zb()},la:function(){N.la()},set:function(e){N.set(e)},h:function(){N.h&&N.h()}}),W=function(){var e=null,t=null,r=0,n=-2,i=-2,a=!1,o=[],u={reset:function(){i=n=-2},o:function(){a||(e=k.createBuffer(),k.bindBuffer(k.ARRAY_BUFFER,e),k.bufferData(k.ARRAY_BUFFER,new Float32Array([-1,-1,3,-1,-1,3]),k.STATIC_DRAW),t=k.createBuffer(),k.bindBuffer(k.ELEMENT_ARRAY_BUFFER,t),k.bufferData(k.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2]),k.STATIC_DRAW),u.pa(),a=!0)},instance:function(e){var t=r++,a=e.da?e.da.length:0,u=void 0===e.mode?k.STATIC_DRAW:e.mode,c=k.createBuffer();k.bindBuffer(k.ARRAY_BUFFER,c),k.bufferData(k.ARRAY_BUFFER,e.Bc instanceof Float32Array?e.Bc:new Float32Array(e.Bc),u),n=t;var s=null,f=null,l=null;if(e.da){s=k.createBuffer(),k.bindBuffer(k.ELEMENT_ARRAY_BUFFER,s);var v=null;65536>e.da.length?(v=Uint16Array,f=k.UNSIGNED_SHORT,l=2):(v=Uint32Array,f=k.UNSIGNED_INT,l=4),k.bufferData(k.ELEMENT_ARRAY_BUFFER,e.da instanceof v?e.da:new v(e.da),u),i=t}var d={Oc:function(e){n!==t&&(k.bindBuffer(k.ARRAY_BUFFER,c),n=t),e&&j.zb()},Lc:function(){i!==t&&(k.bindBuffer(k.ELEMENT_ARRAY_BUFFER,s),i=t)},bind:function(e){d.Oc(e),d.Lc()},ue:function(){k.drawElements(k.TRIANGLES,a,f,0)},ve:function(e,t){k.drawElements(k.TRIANGLES,e,f,t*l)},remove:function(){k.deleteBuffer(c),e.da&&k.deleteBuffer(s),d=null}};return o.push(d),d},pa:function(){-1!==n&&(k.bindBuffer(k.ARRAY_BUFFER,e),n=-1),-1!==i&&(k.bindBuffer(k.ELEMENT_ARRAY_BUFFER,t),i=-1)},g:function(e,t){e&&W.pa(),t&&j.za(),k.drawElements(k.TRIANGLES,3,k.UNSIGNED_SHORT,0)},Vb:function(){k.deleteBuffer(e),k.deleteBuffer(t)},h:function(){u.Vb(),o.forEach((function(e){e.remove()})),k.bindBuffer(k.ARRAY_BUFFER,null),k.bindBuffer(k.ELEMENT_ARRAY_BUFFER,null),u.reset(),a=!1,o.splice(0),r=0}};return u}(),J=function(){var e=null,t=null,r=null,n=!1,i=[],a={v:-2,Sb:1},o={La:function(){return n},o:function(){if(!n){e=k.createFramebuffer();var i=Z.F();t=i&&k.DRAW_FRAMEBUFFER?k.DRAW_FRAMEBUFFER:k.FRAMEBUFFER,r=i&&k.READ_FRAMEBUFFER?k.READ_FRAMEBUFFER:k.FRAMEBUFFER,n=!0}},Se:function(){return t},gb:function(){return r},ca:function(){return k.FRAMEBUFFER},Ze:function(){return a},Le:function(){return e},instance:function(r){void 0===r.cc&&(r.cc=!1);var n=r.X?r.X:null,o=r.width,u=void 0!==r.height?r.height:r.width,c=e,s=null,f=!1,l=!1,v=0;n&&(o=o||n.B(),u=u||n.O());var d={uc:function(){f||(c=k.createFramebuffer(),f=!0,v=a.Sb++)},Ec:function(){d.uc(),d.l(),s=k.createRenderbuffer(),k.bindRenderbuffer(k.RENDERBUFFER,s),k.renderbufferStorage(k.RENDERBUFFER,k.DEPTH_COMPONENT16,o,u),k.framebufferRenderbuffer(t,k.DEPTH_ATTACHMENT,k.RENDERBUFFER,s),k.clearDepth(1)},bind:function(e,r){v!==a.v&&(k.bindFramebuffer(t,c),a.v=v),n&&n.l(),r&&k.viewport(0,0,o,u),e&&k.clear(k.COLOR_BUFFER_BIT|k.DEPTH_BUFFER_BIT)},ge:function(){v!==a.v&&(k.bindFramebuffer(t,c),a.v=v)},clear:function(){k.clear(k.COLOR_BUFFER_BIT|k.DEPTH_BUFFER_BIT)},oe:function(){k.clear(k.COLOR_BUFFER_BIT)},pe:function(){k.clear(k.DEPTH_BUFFER_BIT)},Ud:function(){k.viewport(0,0,o,u)},l:function(){v!==a.v&&(k.bindFramebuffer(t,c),a.v=v)},rtt:function(e){n=e,a.v!==v&&(k.bindFramebuffer(k.FRAMEBUFFER,c),a.v=v),e.l()},H:function(){k.bindFramebuffer(t,null),a.v=-1},resize:function(e,t){o=e,u=t,s&&(k.bindRenderbuffer(k.RENDERBUFFER,s),k.renderbufferStorage(k.RENDERBUFFER,k.DEPTH_COMPONENT16,o,u))},remove:function(){c===e||l||(k.bindFramebuffer(t,c),k.framebufferTexture2D(t,k.COLOR_ATTACHMENT0,k.TEXTURE_2D,null,0),s&&k.framebufferRenderbuffer(t,k.DEPTH_ATTACHMENT,k.RENDERBUFFER,null),k.bindFramebuffer(t,null),k.deleteFramebuffer(c),s&&k.deleteRenderbuffer(s)),l=!0}};return r.cc&&d.Ec(),i.push(d),d},H:function(){k.bindFramebuffer(t,null),a.v=-1},$d:function(){k.bindFramebuffer(t,null),k.clear(k.COLOR_BUFFER_BIT|k.DEPTH_BUFFER_BIT),k.viewport(0,0,Z.B(),Z.O()),a.v=-1},reset:function(){a.v=-2},V:function(){0!==a.v&&(k.bindFramebuffer(t,e),a.v=0)},clear:function(){k.viewport(0,0,Z.B(),Z.O()),k.clear(k.COLOR_BUFFER_BIT)},h:function(){o.H(),i.forEach((function(e){e.remove()})),k.deleteFramebuffer(e),o.reset(),n=!1,i.splice(0),a.v=-2,a.Sb=1}};return o}(),K=function(){function t(e){k.bindTexture(k.TEXTURE_2D,e)}function r(e){var t=new Uint16Array(e.length);return e.forEach((function(e,r){t[r]=function(e){_[0]=e;var t=(e=x[0])>>16&32768,r=e>>12&2047,n=e>>23&255;return 103>n?t:142<n?31744|t|((255==n?0:1)&&8388607&e):113>n?t|((r|=2048)>>114-n)+(r>>113-n&1):t=(t|n-112<<10|r>>1)+(1&r)}(e)})),t}function n(e){if(!j.La()||!d)return null;var t=null;try{if(k.getError(),t=w.instance({isFloat:!1,I:!0,array:e,width:1}),k.getError()!==k.NO_ERROR)return!1}catch(e){return!1}return J.H(),k.viewport(0,0,1,1),k.clearColor(0,0,0,0),k.clear(k.COLOR_BUFFER_BIT),j.set("s0"),t.Gb(0),W.g(!1,!0),e=new Uint8Array(4),k.readPixels(0,0,1,1,k.RGBA,k.UNSIGNED_BYTE,e),e=.9<e[0],t.remove(),J.V(),e}var i=0,a=null,o=0,u=null,c=null,s=null,f=null,l=null,v=null,d=!1,h=[],g={isFloat:!1,isPot:!0,isLinear:!1,isMipmap:!1,isAnisotropicFiltering:!1,isMirrorX:!1,isMirrorY:!1,isSrgb:!1,isKeepArray:!1,isFlipY:null,width:0,height:0,url:null,array:null,data:null,D:null,vd:!1,I:!1,aa:null,Oa:4,ob:0},p=!1,E=null,b=null,R=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],T=!1,y=!1,_=new Float32Array(1),x=new Int32Array(_.buffer),A={ib:null,jb:null},w={o:function(){if(!d){if(l=[k.RGB,!1,k.RGB,k.RGBA],v=[k.RGB,!1,k.RGB,k.RGBA],a=[k.TEXTURE0,k.TEXTURE1,k.TEXTURE2,k.TEXTURE3,k.TEXTURE4,k.TEXTURE5,k.TEXTURE6,k.TEXTURE7],T="undefined"!=typeof JEContext,y=void 0!==Z,T&&JEContext.lf()&&a.push(k.TEXTURE8,k.TEXTURE9),u=[-1,-1,-1,-1,-1,-1,-1,-1],f=[k.UNSIGNED_BYTE,k.FLOAT,k.FLOAT],!c){for(var e=new Float32Array(16384),t=0;16384>t;++t)e[t]=2*Math.random()-1;c={random:w.instance({isFloat:!0,isPot:!0,array:e,width:64}),Ac:w.instance({isFloat:!1,isPot:!0,width:1,array:new Uint8Array([0,0,0,0])})}}d=!0}},td:function(){w.be()},cf:function(){return c.Ac},be:function(){f[1]=Z.Ja()},Od:function(){v=l=[k.RGBA,k.RGBA,k.RGBA,k.RGBA]},rf:function(e,t){Y.set("s1"),J.H();var r=e.B(),n=e.O();k.viewport(0,0,r,n),e.b(0),W.g(!1,!1),k.readPixels(0,0,r,n,k.RGBA,k.UNSIGNED_BYTE,t)},Tb:function(e,r,n,a,o){k.activeTexture(k.TEXTURE0);var c=k.createTexture();t(c);var f=Z.F()&&k.RGBA32F?k.RGBA32F:k.FLOAT;a=a instanceof Float32Array?a:new Float32Array(a),0!=G.Ad(a.length)%1&&(k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_S,k.CLAMP_TO_EDGE),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_T,k.CLAMP_TO_EDGE)),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MAG_FILTER,k.NEAREST),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MIN_FILTER,k.NEAREST),k.pixelStorei(k.UNPACK_FLIP_Y_WEBGL,o),k.texImage2D(k.TEXTURE_2D,0,k.RGBA,r,n,0,k.RGBA,f,a),t(null),k.pixelStorei(k.UNPACK_FLIP_Y_WEBGL,!1),J.V(),Y.set("s0"),k.viewport(0,0,r,n),k.framebufferTexture2D(J.ca(),k.COLOR_ATTACHMENT0,k.TEXTURE_2D,e,0),k.clearColor(0,0,0,0),k.clear(k.COLOR_BUFFER_BIT),t(c),W.g(!0,!1),k.deleteTexture(c),u[0]=-1,s=null,i=0},instance:function(c){function d(){if(t(L),Q&&k.pixelStorei(k.UNPACK_FLIP_Y_WEBGL,Q),_.isPot?(k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_S,_.isMirrorX?k.MIRRORED_REPEAT:k.REPEAT),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_T,_.isMirrorY?k.MIRRORED_REPEAT:k.REPEAT)):(k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_S,k.CLAMP_TO_EDGE),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_T,k.CLAMP_TO_EDGE)),_.isAnisotropicFiltering&&"undefined"!=typeof JESETTINGS&&k.texParameterf(k.TEXTURE_2D,JEContext.Re().TEXTURE_MAX_ANISOTROPY_EXT,JESETTINGS.ee),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MAG_FILTER,_.isLinear?k.LINEAR:k.NEAREST),_.isLinear?k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MIN_FILTER,_.isMipmap&&!ee?k.NEAREST_MIPMAP_LINEAR:k.LINEAR):k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MIN_FILTER,_.isMipmap&&!ee?k.NEAREST_MIPMAP_NEAREST:k.NEAREST),q=l[_.Oa-1],K=v[_.Oa-1],$=f[D],Z.F()){var e=k.RGBA32F;q===k.RGBA&&$===k.FLOAT&&e&&(K=e),q===k.RGB&&$===k.FLOAT&&e&&(K=e,q=k.RGBA)}if((_.I&&!_.isFloat||_.isFloat&&_.isMipmap&&te.zd())&&((e=k.RGBA16F)&&(K=e),$=Z.Ja()),_.ob&&(ne=_.ob),_.isSrgb&&4===_.Oa&&(q=JEContext.af()),_.D)k.texImage2D(k.TEXTURE_2D,0,K,q,$,_.D);else if(_.url)k.texImage2D(k.TEXTURE_2D,0,K,q,$,M);else if(O){try{k.getError(),k.texImage2D(k.TEXTURE_2D,0,K,B,C,0,q,$,O),k.getError()!==k.NO_ERROR&&(k.texImage2D(k.TEXTURE_2D,0,K,B,C,0,q,$,null),k.getError()!==k.NO_ERROR&&k.texImage2D(k.TEXTURE_2D,0,k.RGBA,B,C,0,k.RGBA,k.UNSIGNED_BYTE,null))}catch(e){k.texImage2D(k.TEXTURE_2D,0,K,B,C,0,q,$,null)}_.isKeepArray||(O=null)}else k.texImage2D(k.TEXTURE_2D,0,K,B,C,0,q,$,null);if(_.isMipmap)if(!ee&&oe)oe.fb(),ie=!0;else if(ee){e=Math.log(Math.min(B,C))/Math.log(2),(re=Array(1+e))[0]=L;for(var r=1;r<=e;++r){var n=Math.pow(2,r),a=B/n;n=C/n;var o=k.createTexture();t(o),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MIN_FILTER,k.NEAREST),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MAG_FILTER,k.NEAREST),k.texImage2D(k.TEXTURE_2D,0,K,a,n,0,q,$,null),t(null),re[r]=o}ie=!0}t(null),u[i]=-1,Q&&k.pixelStorei(k.UNPACK_FLIP_Y_WEBGL,!1),N=!0,_.aa&&oe&&(_.aa(oe),_.aa=null)}var _=Object.assign({},g,c),x=o++;null===_.isFlipY&&(_.isFlipY=!(!_.url&&!_.array)),_.data&&(_.array="string"==typeof _.data?function(t){var r=JSON.parse(t);t=r.ne;var n=r.nf,i=r.n,a="undefined"==typeof btoa?e.from(r.data,"base64").toString("latin1"):atob(r.data),o=a.length;r=new Uint8Array(o);for(var u=0;u<o;++u)r[u]=a.charCodeAt(u);a=new Float32Array(i),o=new Float32Array(n),u=t+n+1;for(var c=0;c<i;++c){for(var s=u*c,f=0===m(r,s)?1:-1,l=s+1,v=1,d=0,h=l+t-1;h>=l;--h)d+=v*m(r,h),v*=2;for(l=d,s=s+1+t,v=o.length,d=0,h=s;h<s+v;++h)o[d]=m(r,h),++d;for(v=s=0;v<n;++v)s+=o[v]*Math.pow(2,-v-1);a[c]=0===s&&0===l?0:f*(1+s)*Math.pow(2,1+l-Math.pow(2,t-1))}return a}(_.data):_.isFloat?new Float32Array(_.data):new Uint8Array(_.data),_.isFlipY=!1);var D=0,F=!!_.D,S=null,P=null,U=!1,I=null;_.I=_.I||_.isFloat,_.I&&(D=1),_.vd||Z.F()||!_.isFloat||!y||Z.Ib()||(_.isFloat=!1),_.isFloat&&(D=2),_.isAnisotropicFiltering&&T&&!JEContext.ef()&&(_.isAnisotropicFiltering=!1);var L=k.createTexture(),M=null,O=!1,B=0,C=0,N=!1,G=!1,H=null,X=null,z=null,V=null,K=null,q=null,$=null,Q=_.isFlipY,ee=!(!_.I||!_.isMipmap||void 0===te||te.Rc()),re=null,ne=-1,ie=!1,ae={fc:!1,Hb:null,Ub:null};_.width&&(B=_.width,C=_.height?_.height:B);var oe={get:function(){return L},B:function(){return B},O:function(){return C},df:function(){return _.url},ff:function(){return _.isFloat},hf:function(){return _.I},jf:function(){return _.isLinear},fb:function(){k.generateMipmap(k.TEXTURE_2D)},Nc:function(e,r){ee?(e||(e=oe.Yb()),oe.Ua(r),t(re[e]),u[r]=-1):oe.b(r)},Yb:function(){return-1===ne&&(ne=Math.log(B)/Math.log(2)),ne},kd:function(e){if(ee){e||(e=oe.Yb()),Y.set("s11"),oe.Ua(0);for(var r=B,n=C,i=1;i<=e;++i)r/=2,n/=2,Y.ya("u7",.25/r,.25/n),k.viewport(0,0,r,n),t(re[i-1]),k.framebufferTexture2D(J.ca(),k.COLOR_ATTACHMENT0,k.TEXTURE_2D,re[i],0),W.g(!1,1===i);u[0]=-1}else oe.fb()},Ua:function(e){e!==i&&(k.activeTexture(a[e]),i=e)},b:function(e){return!!N&&(oe.Ua(e),u[e]!==x&&(t(L),u[e]=x,!0))},Gb:function(e){k.activeTexture(a[e]),i=e,t(L),u[e]=x},l:function(){s=oe,k.framebufferTexture2D(J.ca(),k.COLOR_ATTACHMENT0,k.TEXTURE_2D,L,0)},M:function(){s=oe,k.viewport(0,0,B,C),k.framebufferTexture2D(J.ca(),k.COLOR_ATTACHMENT0,k.TEXTURE_2D,L,0)},Ab:w.Ab,resize:function(e,t){B=e,C=t,d()},clone:function(e){return e=w.instance({width:B,height:C,I:_.I,isFloat:_.isFloat,isLinear:_.isLinear,isMirrorY:_.isMirrorY,isFlipY:e?!Q:Q,isPot:_.isPot}),j.set("s0"),J.V(),e.l(),k.viewport(0,0,B,C),oe.b(0),W.g(!0,!0),e},Ud:function(){k.viewport(0,0,B,C)},remove:function(){k.deleteTexture(L),h.splice(h.indexOf(oe),1),oe=null},refresh:function(){oe.Gb(0),Q&&k.pixelStorei(k.UNPACK_FLIP_Y_WEBGL,!0),F?k.texImage2D(k.TEXTURE_2D,0,K,q,k.UNSIGNED_BYTE,_.D):k.texImage2D(k.TEXTURE_2D,0,K,B,C,0,q,$,O),Q&&k.pixelStorei(k.UNPACK_FLIP_Y_WEBGL,!1)},Mb:function(){var e=B*C*4;X=[new Uint8Array(e),new Uint8Array(e),new Uint8Array(e),new Uint8Array(e)],H=[new Float32Array(X[0].buffer),new Float32Array(X[1].buffer),new Float32Array(X[2].buffer),new Float32Array(X[3].buffer)],z=new Uint8Array(4*e),V=new Float32Array(z.buffer),G=!0},tc:function(){G||oe.Mb(),k.readPixels(0,0,B,4*C,k.RGBA,k.UNSIGNED_BYTE,z);for(var e=B*C,t=2*e,r=3*e,n=0;n<e;++n)H[0][n]=V[n],H[1][n]=V[n+e],H[2][n]=V[n+t],H[3][n]=V[n+r];return H},Kd:function(){return ae.fc||(ae.Hb=new Uint8Array(B*C*4),ae.Ub=new Float32Array(ae.buffer),ae.fc=!0),k.readPixels(0,0,B,C,k.RGBA,k.UNSIGNED_BYTE,ae.Hb),ae.Ub},Nb:function(e){if(J.H(),Y.set("s12"),oe.b(0),e)k.viewport(0,0,B,C),Y.yb("u8",.25,.25,.25,.25),W.g(!1,!0);else for(e=0;4>e;++e)k.viewport(0,C*e,B,C),Y.yb("u8",R[e]),W.g(!1,0===e)},ae:function(e){var r=$===f[0]&&!function(){if(null!==A.jb)return A.jb;var e=n(new Uint8Array([255,255,255,255]));return null===e||(A.jb=e)}();t(L),Q&&k.pixelStorei(k.UNPACK_FLIP_Y_WEBGL,!0),r?(U||((S=document.createElement("canvas")).width=B,S.height=C,P=S.getContext("2d"),I=P.createImageData(B,C),U=!0),I.data.set(e),P.putImageData(I,0,0),k.texImage2D(k.TEXTURE_2D,0,K,q,$,S)):k.texImage2D(k.TEXTURE_2D,0,K,B,C,0,q,$,e),u[i]=x,Q&&k.pixelStorei(k.UNPACK_FLIP_Y_WEBGL,!1)},Gf:function(e,r){t(L),r&&k.pixelStorei(k.UNPACK_FLIP_Y_WEBGL,!0),k.texImage2D(k.TEXTURE_2D,0,K,q,$,e),u[i]=x,r&&k.pixelStorei(k.UNPACK_FLIP_Y_WEBGL,!1)},wf:function(e,t){var r=B*C,n=4*r;e=_.I?e?"RGBE":"JSON":"RGBA",t&&(e=t),t=Z.F()&&!1;var i=null;switch(e){case"RGBE":i="s40";break;case"JSON":i=t?"s0":"s12";break;case"RGBA":case"RGBAARRAY":i="s6"}if(G||("RGBA"===e||"RGBE"===e||"RGBAARRAY"===e?(X=new Uint8Array(n),G=!0):"JSON"!==e||t||oe.Mb()),J.H(),Y.set(i),oe.b(0),n=null,"RGBA"===e||"RGBE"===e||"RGBAARRAY"===e){if(k.viewport(0,0,B,C),W.g(!0,!0),k.readPixels(0,0,B,C,k.RGBA,k.UNSIGNED_BYTE,X),"RGBAARRAY"===e)return{data:X};p||(E=document.createElement("canvas"),b=E.getContext("2d"),p=!0),E.width=B,E.height=C,(r=b.createImageData(B,C)).data.set(X),b.putImageData(r,0,0),n=E.toDataURL("image/png")}else if("JSON"===e)if(t)n=new Float32Array(r),k.viewport(0,0,B,C),W.g(!0,!0),k.readPixels(0,0,B,C,k.RGBA,k.FLOAT,n);else{for(n=0;4>n;++n)k.viewport(0,C*n,B,C),Y.yb("u8",R[n]),W.g(!n,!n);for(oe.tc(),n=Array(r),t=0;t<r;++t)n[4*t]=H[0][t],n[4*t+1]=H[1][t],n[4*t+2]=H[2][t],n[4*t+3]=H[3][t]}return{format:e,data:n,width:B,height:C,isMirrorY:_.isMirrorY,isFlipY:"RGBA"===e?_.isFlipY:!_.isFlipY}}};if(_.isMipmap&&!ee&&N&&!ie&&(oe.fb(),ie=!0),_.url)t(L),k.texImage2D(k.TEXTURE_2D,0,k.RGBA,1,1,0,k.RGBA,k.UNSIGNED_BYTE,null),(M=new Image).se="Anonymous",M.crossOrigin="Anonymous",M.src=_.url,M.onload=function(){B=M.width,C=M.height,d()};else if(_.D){var ue=function(){B=void 0!==_.D.videoWidth?_.D.videoWidth:_.D.width,C=void 0!==_.D.videoHeight?_.D.videoHeight:_.D.height,B?d():setTimeout(ue,1)};ue()}else _.array?(_.I&&!_.isFloat?_.array instanceof Uint16Array?(O=_.array,d()):function(){if(null!==A.ib)return A.ib;var e=n(r([1,1,1,1]));return null===e||(A.ib=e)}()?(O=r(_.array),d()):(d(),w.Tb(L,oe.B(),oe.O(),_.array,Q)):(O=_.isFloat?_.array instanceof Float32Array?_.array:new Float32Array(_.array):_.array instanceof Uint8Array?_.array:new Uint8Array(_.array),d()),_.isKeepArray||(O&&O!==_.array&&(O=null),delete _.array)):d();return oe.$e=oe.B,_.aa&&N&&(_.aa(oe),_.aa=null),h.push(oe),oe},H:function(e){e!==i&&(k.activeTexture(a[e]),i=e),u[e]=-1,t(null)},ie:function(e){c.random.b(e)},Ab:function(){s=null,k.framebufferTexture2D(J.ca(),k.COLOR_ATTACHMENT0,k.TEXTURE_2D,null,0)},reset:function(){for(var e=0;e<a.length;++e)u[e]=-1;i=-1},uf:function(){i=-1},Zd:function(){for(var e=0;e<a.length;++e)w.H(e)},Vb:function(){c&&(c.random.remove(),c.Ac.remove())},Ff:function(e,t){if("RGBA"===e.format||"RGBE"===e.format){var r=new Image;r.src=e.data,r.onload=function(){w.instance({isMirrorY:e.isMirrorY,isFlipY:e.isFlipY,isFloat:!1,D:r,aa:function(r){if("RGBA"===e.format)t(r);else{var n=e.width,i=e.height,a=w.instance({isMirrorY:e.isMirrorY,isFloat:!0,width:n,height:i,isFlipY:e.isFlipY});J.V(),k.viewport(0,0,n,i),Y.set("s41"),a.l(),r.b(0),W.g(!0,!0),w.H(0),t(a),k.flush(),setTimeout(r.remove,50)}}})}}else"JSON"===e.format?t(w.instance({isFloat:!0,isFlipY:e.isFlipY,width:e.width,height:e.height,array:new Float32Array(e.data)})):t(!1)},h:function(){s&&(Q.V(),w.Ab(),Q.H()),w.Zd(),h.slice(0).forEach((function(e){e.remove()})),h.splice(0),d=!1,o=0,te.h()}};return w}(),q={instance:function(e){var t=[K.instance(e),K.instance(e)],r=[t[1],t[0]],n=r,i={Rd:function(e){n[1].l(),n[0].b(e),i.xc()},xf:function(e){n[1].M(),n[0].b(e),i.xc()},xc:function(){n=n===t?r:t},refresh:function(){n[0].refresh(),n[1].refresh()},b:function(e){n[0].b(e)},he:function(e){n[1].b(e)},Ue:function(){return n[0]},remove:function(){n[0].remove(),n[1].remove(),n=null}};return i}},Z=function(){function e(){t=void 0===V?JEContext:V,r=!0}var t=null,r=!1,n=!1,i=null,a=null,o=null,u=!1,c=null,s=!1,f=null,l=!1,v=!0,d=!0,h=!0,m=null,g="undefined"==typeof window?{}:window,p={o:function(){return!!r||(e(),p.Qb(),p.eb(),p.fd(),p.gd(),J.o(),K.o(),!!p.ad()&&(W.o(),K.td(),!0))},B:function(){return r||e(),t.B()},O:function(){return r||e(),t.O()},F:function(){return r||e(),t.F()},fd:function(){l=!!(f=k.getExtension("EXT_color_buffer_float")||k.getExtension("WEBGL_color_buffer_float")||k.getExtension("OES_color_buffer_float")),g.GL_EXT_COLORBUFFERFLOAT=f},gd:function(){k.getExtension("EXT_color_buffer_half_float")||k.getExtension("WEBGL_color_buffer_half_float")||k.getExtension("OES_color_buffer_half_float")},Qb:function(){n||(i=k.getExtension("OES_texture_float")||k.getExtension("MOZ_OES_texture_float")||k.getExtension("WEBKIT_OES_texture_float"),(!!(g.GL_EXT_FLOAT=i)||this.F())&&(a=k.getExtension("OES_texture_float_linear")||k.getExtension("MOZ_OES_texture_float_linear")||k.getExtension("WEBKIT_OES_texture_float_linear"),g.GL_EXT_FLOATLINEAR=a),n=!0)},eb:function(){s||((o=k.getExtension("OES_texture_half_float")||k.getExtension("MOZ_OES_texture_half_float")||k.getExtension("WEBKIT_OES_texture_half_float"))&&(m=o.HALF_FLOAT_OES,u=!0),!m&&k.HALF_FLOAT&&(m=k.HALF_FLOAT),!m&&k.FLOAT&&(m=k.FLOAT),g.GL_EXT_HALFFLOAT=o,(u||this.F())&&(c=k.getExtension("OES_texture_half_float_linear")||k.getExtension("MOZ_OES_texture_half_float_linear")||k.getExtension("WEBKIT_OES_texture_half_float_linear"),g.GL_EXT_HALFFLOATLINEAR=c),s=!0)},Ja:function(){return p.eb(),m},Ib:function(){return v},Qc:function(){return d},je:function(){return h},Pc:function(){return l},cd:function(){d=v=!0;var e=k.createFramebuffer();k.bindFramebuffer(k.FRAMEBUFFER,e);var t=k.createTexture();k.bindTexture(k.TEXTURE_2D,t),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MAG_FILTER,k.NEAREST),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MIN_FILTER,k.NEAREST),k.texImage2D(k.TEXTURE_2D,0,p.F()&&k.RGBA32F?k.RGBA32F:k.RGBA,1,1,0,k.RGBA,k.FLOAT,null),k.framebufferTexture2D(J.ca(),k.COLOR_ATTACHMENT0,k.TEXTURE_2D,t,0);var r=k.checkFramebufferStatus(J.gb());r!==k.FRAMEBUFFER_COMPLETE&&(v=!1),k.texImage2D(k.TEXTURE_2D,0,p.F()&&k.RGBA16F?k.RGBA16F:k.RGBA,1,1,0,k.RGBA,p.Ja(),null),k.framebufferTexture2D(J.ca(),k.COLOR_ATTACHMENT0,k.TEXTURE_2D,t,0),(r=k.checkFramebufferStatus(J.gb()))!==k.FRAMEBUFFER_COMPLETE&&(d=!1),k.bindTexture(k.TEXTURE_2D,null),k.bindFramebuffer(k.FRAMEBUFFER,null),k.deleteTexture(t),k.deleteFramebuffer(e)},bd:function(){var e=J.instance({width:1});e.uc();var t=K.instance({width:1,isFloat:!0,Oa:3});e.l(),t.l(),k.flush(),k.checkFramebufferStatus(J.gb())!==k.FRAMEBUFFER_COMPLETE?(K.Od(),h=!1):h=!0,e.remove(),t.remove()},ad:function(){return p.cd(),!(!v&&!d||(p.bd(),0))},h:function(){K.h(),j.h(),J.h(),W.h(),r=!1}};return p}(),$=W,Q=J,ee=K,te=function(){function e(e,t,r,n){k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MIN_FILTER,n?k.NEAREST_MIPMAP_NEAREST:k.LINEAR);var i=null;if(null!==r)try{if((i=k.getError())!==k.NO_ERROR&&console.log("GLERR in test_mipmapping():",i),k.texImage2D(k.TEXTURE_2D,0,e,2,2,0,k.RGBA,t,r),(i=k.getError())!==k.NO_ERROR)return!1}catch(e){return!1}return n&&k.generateMipmap(k.TEXTURE_2D),$.pa(),$.g(!1,!0),"FUCKING_BIG_ERROR"!==(i=k.getError())&&(k.readPixels(0,0,1,1,k.RGBA,k.UNSIGNED_BYTE,o),(i=k.getError())===k.INVALID_OPERATION&&void 0!==k.PIXEL_PACK_BUFFER&&(k.bindBuffer(k.PIXEL_PACK_BUFFER,null),k.readPixels(0,0,1,1,k.RGBA,k.UNSIGNED_BYTE,o),i=k.getError()),i===k.NO_ERROR&&0!==o[0])}function t(t){return!(!Z.Ib()||!e(f,k.FLOAT,new Float32Array(c),t)||(a=i.Db,0))}function r(t,r){return!(!Z.Qc()||(e(l,Z.Ja(),new Uint16Array(c),t)||e(l,k.FLOAT,new Float32Array(c),t)?(a=i.Da,0):(k.bindTexture(k.TEXTURE_2D,r),k.texImage2D(k.TEXTURE_2D,0,k.RGBA,1,1,0,k.RGBA,k.UNSIGNED_BYTE,null),K.Tb(r,1,1,new Float32Array(c),!1),k.bindTexture(k.TEXTURE_2D,r),!e(l,null,null,t)||(a=i.Da,0))))}var n=!1,i={Db:3,Da:2,RGBA8:0},a=i.RGBA8,o=new Uint8Array(4),u=[.8,1,.8,1],c=u.concat(u,u,u),s=!0,f=null,l=null,v={o:function(){if(Z.Qb(),Z.eb(),l=f=k.RGBA,V.F()){var e=k.RGBA32F;e&&(f=e),(e=k.RGBA16F)&&(l=e)}if($.o(),Q.reset(),Q.H(),k.viewport(0,0,1,1),Y.set("s0"),n=!0,e=k.createTexture(),k.activeTexture(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,e),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_S,k.REPEAT),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_T,k.REPEAT),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MAG_FILTER,k.NEAREST),r(!0,e)||t(!0))return!0;if(s=!1,r(!1,e)||t(!1))return!0;if(V.F()){if(l=f=k.RGBA,r(!0)||t(!0))return!0;if(s=!1,r(!1)||t(!1))return!0}return!1},Rc:function(){return s},Ve:function(){return a},gf:function(){return n||v.o(),a===i.Db},zd:function(){return n||v.o(),a===i.Da},h:function(){n=!1,a=i.RGBA8,s=!0}};return v}(),re={instance:function(e){var t=ee.instance(e.alpha),r=ee.instance(e.beta);return{ed:function(){t.b(1),r.b(2)}}}},ne={instance:function(e){var t=null,r=!1,n=!1,i=null,a=!1,o=!1,u=null,c=void 0!==e.preprocessing&&e.preprocessing,s=void 0===e.preprocessingSize?e.size:e.preprocessingSize;e.mask&&(r=!0,ve&&void 0!==ve.Kc&&(e.mask=ve.Kc+e.mask),t=ee.instance({isFloat:!1,url:e.mask}));var f=!1;switch(e.customInputShader&&(f="s42",Y.Eb({name:"_",id:f,a:e.customInputShader,c:["uSource"],precision:"lowp"}),Y.K(f,[{type:"1i",name:"_",value:0}])),c){case"sobel":u="s31",a=!0;break;case"meanNormalization":u="s32",a=!0;break;case"grayScale":u="s28",a=!1;break;case"grayScaleTilt":u="s29",o=!0,a=!1;break;case"rgbGrayTilt":u="s30",o=!0,a=!1;break;case"copy":u=f||"s0";break;case"inputLightRegulation":u=f||"s28",i=fe.instance({bc:s,rc:e.size,kc:e.nBlurPass,yd:!1}),n=!0;break;case"direct":case"none":u=!1;break;default:u="s3"}o&&Y.K(u,[{name:"u26",type:"1f",value:e.tilt}]),r&&(u+="Mask");var l=ee.instance({isFloat:!1,isPot:!1,width:e.size}),v={B:function(){return s},hb:function(){return v.B()},pd:function(){return n?i.Zb():l},J:function(){Q.V(),u&&(Y.set(u),a&&Y.A("u27",1/e.size),l.M(),r&&t.b(1),$.g(!1,!1),l.b(0),n&&i.process(l))},h:function(){l.remove(),r&&t.remove()}};return v}},ie={instance:function(e){void 0===e.disableNormalize&&(e.disableNormalize=!1);var t={input:null,ha:null,lb:null,T:null,Qa:null,tb:null,ub:null},r=null,n=[],i=[],a=!1,o=null,u=!0,c=-1,s=!!e.isReorganize&&e.isReorganize,f=!!e.kernelsNumber,l=!!e.dynPelu&&re.instance(e.dynPelu),v=!!l,d={isEnabled:!1};e.xd?(e.sparsity=void 0!==e.sparsity?e.sparsity:e.Ra.hb(),u=!1):"full"===e.connectivityUp&&(e.sparsity=e.Ra.hb());var h={elu:"s15",elu01:"s16",relu:"s14",arctan:"s18",sigmoid:"s13",copy:"s0",softplus:"s19",dynPelu:"s17"}[e.activation],m=e.sparsity*e.sparsity,g=!1,p=e.size,E="";if(e.maxPooling){switch(e.maxPooling.size){case 2:E="s33";break;case 4:E="s34"}g=!0,p/=e.maxPooling.size,t.tb=ee.instance({isFloat:!0,isPot:!1,width:p})}var b=!(void 0===e.Gd||!e.Gd),R=null,T=null,y=null;if(b){R="s43"+e.index.toString(),Y.ac("s43",R,[((e.normalization.n-1)/2).toFixed(1)]),Y.K(R,[{type:"1i",name:"u1",value:0},{type:"2f",name:"u7",value:[1/e.size,1/e.size]},{type:"1f",name:"u6",value:e.normalization.alpha},{type:"1f",name:"u9",value:e.normalization.beta},{type:"1f",name:"u31",value:e.normalization.k}]);var _={isFloat:!0,isPot:!0,width:e.size};T=ee.instance(_),y=ee.instance(_)}var x=-1,A=null;u&&(t.T=ee.instance({isFloat:!0,isPot:!1,width:e.size})),t.ha=ee.instance(e.bias);var w={B:function(){return e.size},hb:function(){return p},Wb:function(){return e.classesCount},Mc:function(e){r.b(e)},Id:function(){e.remap&&e.remap.isEnabled&&(d={isEnabled:!0,Cd:ee.instance({isFloat:!1,isFlipY:!1,array:new Uint8Array(e.remap.maskTexture.data),width:e.remap.maskTexture.width,isPot:!1}),layers:e.remap.layers.map((function(t){return e.parent.od(t)})),depth:e.remap.depth})},Qd:function(){switch(e.connectivityUp){case"direct":A=ae.instance(e.connectivity);break;case"square":A=ue.instance(e.connectivity);break;case"squareFast":A=se.instance(e.connectivity,e.activation);break;case"full":A=oe.instance(e.connectivity);break;case"conv":c=e.kernelsNumber,A=ce.instance(e.connectivity),s&&(t.Qa=ee.instance({width:p,isFloat:!0,isFlipY:!1,isPot:!1}))}if(A.ka){var r=e.size*e.sparsity;x=Math.log(r/e.size)/Math.log(2),t.input=ee.instance({isMipmap:!0,isFloat:!0,isPot:!0,width:r,ob:x}),t.lb=ee.instance({isFloat:!0,isPot:!0,width:e.size})}},J:function(n){if(r=n,A.ka?(t.input.M(),f&&t.ha.b(2),A.J(d),t.input.b(0),t.input.kd(x),t.lb.M(),f?Y.set("s0"):(Y.set("s27"),Y.A("u25",m),t.ha.b(1)),t.input.Nc(x,0),$.g(!1,!1),Y.set(h),b?T.l():t.T.l(),t.lb.b(0),v&&l.ed(),$.g(!1,!1)):(t.T.M(),t.ha.b(1),A.J()),b&&(Y.set(R),y.l(),T.b(0),$.g(!1,!1),Y.set("s44"),Y.A("u6",1),t.T.l(),y.b(1),$.g(!1,!1)),u)return g?(t.tb.M(),t.T.b(0),Y.set(E),Y.ya("u7",1/e.size,1/e.size),$.g(!1,!1),n=t.tb):n=t.T,n.b(0),s&&(t.Qa.l(),Y.set("s21"),Y.ya("u12",c,p/c),$.g(!1,!1),n=t.Qa,t.Qa.b(0)),n;switch(n=t.T,e.disableNormalize||(Y.set("gpuRawAvg"===a?"s8":"s7"),Y.A("u4",1/e.size),t.ub.M(),t.T.b(0),$.g(!1,!1),n=t.ub),a){case"cpuRGBA2Float":n.Nb(!1),n=w.Jd(n),o(n);break;case"cpuMeanFloat":n.Nb(!0),n=n.Kd(),o(n);break;case"gpuRawAvg":case"gpuRaw":n.b(0);case"none":o(n)}return!1},Zc:function(r){r&&void 0!==r.qc&&(a=r.qc,o=r.Hd),t.T=ee.instance({isFloat:!0,isPot:!0,isMipmap:!1,width:e.size}),r=void 0!==e.classesCount&&e.classesCount?e.classesCount:e.size*e.size;for(var u=0,c=0,s=0;u<r;++u)n.push(c+(e.size-1-s)*e.size),i.push([-1,-1,-1,-1]),++c===e.size&&(c=0,++s);e.disableNormalize||(t.ub=ee.instance({isFloat:!0,isPot:!0,width:e.size}))},Jd:function(e){var t=e.tc();return n.forEach((function(e,r){i[r][0]=t[0][e],i[r][1]=t[1][e],i[r][2]=t[2][e],i[r][3]=t[3][e]})),i},h:function(){for(var e in t){var r=t[e];r&&r.remove()}A&&(A.h(),A=null)}};return e.Ra&&w.Qd(e.Ra),w}};t.Ob=function(e){e.forEach((function(e){e.Xc&&ee.Ob(e.Xc.Hf),e.ha&&ee.Ob(e.ha)}))};var ae={instance:function(e){var t=ee.instance(e.weights);return delete e.weights.data,{ka:!0,Ia:function(){return 1},h:function(){t.remove()},sd:function(){return t},J:function(){Y.set("s26"),t.b(1),$.g(!1,!1)}}}},oe={instance:function(e){var t=e.fromLayerSize,r=ee.instance(e.weights);return delete e.weights.data,{ka:!0,Ia:function(){return t},h:function(){r.remove()},J:function(t){if(t.isEnabled){Y.set("s24"),t.Cd.b(3);var n,i=Math.min(t.layers.length,t.depth);for(n=0;n<i;++n)t.layers[n].Mc(4+n)}else Y.set("s23");Y.A("u16",e.toLayerSize),r.b(1),$.g(!1,!1)}}}},ue={instance:function(e){for(var t=e.fromLayerSize,r=e.toLayerSize,n=e.toSparsity,i=n*r,a=i/t,o=t/r,u=0,c=0,s=Array(n*r*n*r*4),f=Array(n*r*n*r*4),l=Array(t*t),v=0;v<l.length;++v)l[v]=0;v=Math.floor(n/2);for(var d=.5/r,h=.5/t,m=.5/i,g=0;g<r;++g)for(var p=Math.round(g*o),E=0;E<r;++E){var b=Math.round(E*o),R=g/r,T=E/r;R+=d,T+=d;for(var y=0;y<n;++y){var _=p+y-v;0>_&&(_+=t),_>=t&&(_-=t);for(var x=0;x<n;++x){var A=u/i,w=c/i,D=b+x-v;0>D&&(D+=t),D>=t&&(D-=t);var F=_/t,S=D/t;w=1-w-1/i,F+=h,S+=h,A+=m,w+=m;var P=g*n+y,U=E*n+x;s[4*(P=(U=r*n-U-1)*r*n+P)]=A,s[4*P+1]=w,s[4*P+2]=F,s[4*P+3]=S,S=l[D*t+_]++,f[4*(D=(D=t*a-1-(D=D*a+(S-(P=S%a))/a))*t*a+(F=_*a+P))]=A,f[4*D+1]=w,f[4*D+2]=R,f[4*D+3]=T,++u>=i&&(u=0,++c)}}}l=null;var I=ee.instance(e.weights);delete e.weights.data;var L=ee.instance({width:i,isFloat:!0,array:new Float32Array(f),isPot:!0});f=null;var M=ee.instance({width:i,isFloat:!0,array:new Float32Array(s),isPot:!0});return s=null,{ka:!0,Ia:function(){return a},h:function(){L.remove(),M.remove(),I.remove()},J:function(){Y.set("s22"),I.b(1),M.b(2),$.g(!1,!1)}}}},ce={instance:function(e){var t=e.kernelsNumber,r=e.toSparsity,n=r*e.toLayerSize/e.fromLayerSize,i=ee.instance(e.weights);return delete e.weights.data,{ka:!0,Ia:function(){return n},bf:function(){return r},sd:function(){return i},h:function(){i.remove()},J:function(){Y.set("s25"),Y.A("u22",t),Y.A("u23",r),Y.A("u16",e.toLayerSize),Y.A("u24",e.fromLayerSize),i.b(1),$.g(!1,!1)}}}},se={instance:function(e,t){var r=e.fromLayerSize,n=e.toLayerSize,i=e.toSparsity,a=e.stride?e.stride:1,o=i*n/r,u=n<r,c=r/n,s=ee.instance(e.weights);delete e.weights.data;var f="s45"+[r.toString(),n.toString(),i.toString(),a.toString(),t].join("_");return Y.hd(f)||(e=z(t,"gl_FragColor","gl_FragColor"),n=[{type:"1f",name:"u16",value:n},{type:"1f",name:"u30",value:a}],u&&n.push({type:"1f",name:"u24",value:r}),r=[(u?o:i).toFixed(1),e],u&&r.push(c.toFixed(1)),Y.ac(u?"s39":"s38",f,r),Y.K(f,n.concat([{type:"1i",name:"u14",value:0},{type:"1i",name:"u21",value:1},{type:"1i",name:"u13",value:3}]))),{ka:!1,Ia:function(){return o},h:function(){s.remove()},J:function(){Y.set(f),s.b(3),$.g(!1,!1)}}}},fe={instance:function(e){var t=e.kc?e.kc:3,r=e.bc?e.bc:64,n=e.rc?e.rc:64,i=!!e.yd;e={isFloat:!1,width:r,isPot:!1,isFlipY:!1};var a=ee.instance(e),o=ee.instance(e),u=ee.instance(e),c=ee.instance(e),s=ee.instance({isFloat:!0,width:n,isPot:!1,isFlipY:!1}),f=1/r;return{process:function(e){Y.set("s35"),c.l(),$.g(i,!1),Y.set("s36");for(var r=0;r<t;++r)a.l(),Y.ya("u7",f,0),$.g(i,!1),u.l(),c.b(0),$.g(i,!1),o.l(),a.b(0),Y.ya("u7",0,f),$.g(i,!1),c.l(),u.b(0),$.g(i,!1),r!==t-1&&o.b(0);Y.set("s37"),s.l(),e.b(0),o.b(1),c.b(2),$.g(i,!1),s.b(0)},Zb:function(){return s}}}},le={rd:function(){return!!le.Lb()&&document.createElement("video")},ta:function(e,t){e[t]=!0,e.setAttribute(t,"true")},Uc:function(){var e=!1,t=navigator.userAgent||navigator.vendor||window.opera;return(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0),e},Jb:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream},md:function(){var e=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);return 2<e.length?[parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3]||0,10)]:[0,0,0]},hc:function(){try{return!!window.matchMedia("(orientation: portrait)").matches}catch(e){return window.innerHeight>window.innerWidth}},Tc:function(){return le.Kb()||le.Jb()},Kb:function(){var e=navigator.userAgent.toLowerCase();return-1!==e.indexOf("safari")&&-1===e.indexOf("chrome")},Je:function(){return le.Uc()&&le.hc()?window.innerHeight/window.innerWidth*45:45},Lb:function(){return!(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)},pause:function(e){e.pause()},vf:function(e){e.play()},release:function(e){e.pause(),e.videoStream&&e.videoStream.stop(),e.videoStream=null},Wc:function(e){if(!e)return e;var t=!1;if(e.video){var r=function(e){var t={};return void 0!==e.min&&(t.min=e.min),void 0!==e.max&&(t.max=e.max),void 0!==e.ideal&&(t.ideal=e.ideal),t};t={},void 0!==e.video.width&&(t.width=r(e.video.width)),void 0!==e.video.height&&(t.height=r(e.video.height)),void 0!==e.video.facingMode&&(t.facingMode=e.video.facingMode)}return t={audio:e.audio,video:t},void 0!==e.deviceId&&(t.deviceId=e.deviceId),t},yc:function(e){var t=e.video.width;return e.video.width=e.video.height,e.video.height=t,e},Yc:function(e){function t(e){return[480,576,640,648,720,768,800,960,1080,1152,1280,1366,1920].sort((function(t,r){return Math.abs(t-e)-Math.abs(r-e)}))}function r(t){var r=le.Wc(e);n.push(t(r))}var n=[];if(!e||!e.video)return n;if(e.video.width&&e.video.height){if(e.video.width.ideal&&e.video.height.ideal){var i=t(e.video.width.ideal).slice(0,3),a=t(e.video.height.ideal).slice(0,3),o={},u=0;for(o.$=void 0;u<i.length;o={$:o.$},++u){o.$=i[u];var c={},s=0;for(c.Z=void 0;s<a.length;c={Z:c.Z},++s)if(c.Z=a[s],o.$!==e.video.width.ideal||c.Z!==e.video.height.ideal){var f=Math.max(o.$,c.Z)/Math.min(o.$,c.Z);f<4/3-.1||f>16/9+.1||r(function(e,t){return function(r){return r.video.width.ideal=e.$,r.video.height.ideal=t.Z,r}}(o,c))}}}r((function(e){return le.yc(e)}))}return e.video.width&&e.video.height&&(e.video.width.ideal&&e.video.height.ideal&&r((function(e){return delete e.video.width.ideal,delete e.video.height.ideal,e})),r((function(e){return delete e.video.width,delete e.video.height,e}))),e.video.facingMode&&(r((function(e){return delete e.video.facingMode,e})),e.video.width&&e.video.height&&r((function(e){return le.yc(e),delete e.video.facingMode,e}))),n.push({audio:e.audio,video:!0}),n},Xd:function(e){if(le.hc()){if(!e||!e.video)return!1;var t=e.video.width,r=e.video.height;if(!t||!r)return!1;if(t.ideal&&r.ideal&&t.ideal>r.ideal)return e.video.height=t,e.video.width=r,!0}return!1},Na:function(e){if(e.volume=0,le.ta(e,"muted"),le.Kb()){if(1===e.volume){var t=function(){e.volume=0,window.removeEventListener("mousemove",t,!1),window.removeEventListener("touchstart",t,!1)};window.addEventListener("mousemove",t,!1),window.addEventListener("touchstart",t,!1)}setTimeout((function(){e.volume=0,le.ta(e,"muted")}),5)}},zc:function(e,t,r){return new Promise((function(n,i){if(e.srcObject&&e.srcObject.getVideoTracks){var a=e.srcObject.getVideoTracks();1!==a.length?i("INVALID_TRACKNUMBER"):(a=a[0],t?le.get(e,n,i,r):(a.stop(),n()))}else i("BAD_IMPLEMENTATION")}))},$b:function(e,t,r,n){function i(e){a||(a=!0,r(e))}var a=!1;return navigator.mediaDevices.getUserMedia(n).then((function(r){function n(){setTimeout((function(){if(e.currentTime){var n=e.videoWidth,o=e.videoHeight;if(0===n||0===o)i("VIDEO_NULLSIZE");else{n&&(e.style.width=n.toString()+"px"),o&&(e.style.height=o.toString()+"px"),n={Sc:null,Vd:null,Dd:null};try{var u=r.getVideoTracks()[0];u&&(n.Dd=u,n.Sc=u.getCapabilities(),n.Vd=u.getSettings())}catch(e){}le.Tc()?e.parentNode&&null!==e.parentNode?(a||t(e,r,n),setTimeout((function(){e.play()}),100)):(document.body.appendChild(e),le.Na(e),a||t(e,r,n),setTimeout((function(){e.style.transform="scale(0.0001,0.0001)",e.style.position="fixed",e.style.bottom="0px",e.style.right="0px",le.Na(e),setTimeout((function(){e.play()}),100)}),80)):a||t(e,r,n)}}else i("VIDEO_NOTSTARTED")}),700)}void 0!==e.srcObject?e.srcObject=r:(e.src=window.URL.createObjectURL(r),e.videoStream=r),le.Na(e),e.addEventListener("loadeddata",(function(){var t=e.play();le.Na(e),void 0===t?n():t.then((function(){n()})).catch((function(){i("VIDEO_PLAYPROMISEREJECTED")}))}),!1)})).catch((function(e){i(e)}))},get:function(e,t,r,n){if(!e)return r&&r("VIDEO_NOTPROVIDED"),!1;if(!le.Lb())return r&&r("MEDIASTREAMAPI_NOTFOUND"),!1;if(n&&n.video){if(le.Jb()){var i=le.md();(12>i[0]||12===i[0]&&2>i[1])&&le.Xd(n)}n.video.width&&n.video.width.ideal&&(e.style.width=n.video.width.ideal+"px"),n.video.height&&n.video.height.ideal&&(e.style.height=n.video.height.ideal+"px")}le.ta(e,"autoplay"),le.ta(e,"playsinline"),n&&n.audio?e.volume=0:le.ta(e,"muted"),le.$b(e,t,(function(){!function n(i){if(0===i.length)r("INVALID_FALLBACKCONSTRAINTS");else{var a=i.shift();le.$b(e,t,(function(){n(i)}),a)}}(le.Yc(n))}),n)},qd:function(e){if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return e(!1,"NOTSUPPORTED"),!1;navigator.mediaDevices.enumerateDevices().then((function(t){(t=t.filter((function(e){return e.kind&&-1!==e.kind.toLowerCase().indexOf("video")&&e.label&&e.deviceId})))&&t.length&&0<t.length?e(t,!1):e(!1,"NODEVICESFOUND")})).catch((function(){e(!1,"PROMISEREJECTED")}))},ke:function(e,t,r){var n={};n[t]=r,(t=[]).push(n),e.applyConstraints({advanced:t}).catch((function(){}))}},ve={save:"NNC.json",Fb:0,Jc:25,Va:.2,ga:[45,55],fe:1/3.5,Ca:[2,7],Ld:{minScale:.15,maxScale:.6,borderWidth:.2,borderHeight:.2,nStepsX:6,nStepsY:5,nStepsScale:3,nDetectsPerLoop:-1},Yd:50,jc:.5,pb:.4,Ed:8,Dc:.8,Cc:1,Wd:{translationFactorRange:[.0015,.005],rotationFactorRange:[.003,.02],qualityFactorRange:[.9,.98],alphaRange:[.05,1]},Ba:[.65,1,.262],ea:[.092,.092,.3],Gc:.2,Ic:2,Hc:.1,Fd:8,nc:1,jd:X.Ma.bind(null,.3,.7),ce:20,wc:3},de={facingMode:"user",idealWidth:800,idealHeight:600,minWidth:480,maxWidth:1280,minHeight:480,maxHeight:1280,rotate:0,flipX:!1},he={rb:-3,Bd:-1,error:-2,play:1,pause:2},me=he.rb,ge=null,pe={nb:!1,element:null,X:null,Y:null,u:[0,0],C:[.5,.5],m:[.5,0,0,.5],Sa:0,ra:null,mb:!1},Ee=null,be={qa:null,Ga:null,Cb:"./",ma:null,W:null,Ea:ve.Fb,sc:ve.Fb,Ka:!1,ia:!1},Re=null,Te=null,ye=null,_e=u=h=d=v=l=f=s=c=0,xe=1,Ae=i=o=a=n=r=0,we={xb:-1,Xa:-1},De=null,Fe={N:0,P:0,u:[0,0],va:null},Se={Aa:null,buffer:null,ea:null,Ba:null,S:ve.nc,ua:null},Pe=null,Ue=null,Ie=null,Le=null,Me={i:1,ba:0,L:null,ec:!1,ic:0,sb:0},Oe={sa:0,timestamp:0,lc:0,mc:0,G:ve.Ca[0],qb:ve.Ca[0],oc:0,ja:0,qe:1},Be=[],Ce=[],Ne={VERSION:"1.3.1",init:function(e){function r(){me!==he.error&&2==++i&&(L(),U(),I(),Ee.qa&&(Ee.qa(!1,{GL:k,canvasElement:Ee.W,videoTexture:ge.Y.get(),maxFacesDetected:Me.i,videoElement:ge.element}),T()),E())}if(me!==he.rb)return e.callbackReady&&e.callbackReady("ALREADY_INITIALIZED"),!1;if(me=he.Bd,ge=Object.assign({},pe),Ee=Object.assign({},be),De=Object.assign({},Fe),Me.L=[0],Se.ea=ve.ea.slice(0),Se.Ba=ve.Ba.slice(0),e.callbackReady&&(Ee.qa=e.callbackReady),e.callbackTrack&&(Ee.Ga=e.callbackTrack),e.nExpressions&&(Se.S=e.nExpressions),e.expressionsEasings&&(Se.ua=e.expressionsEasings),void 0!==e.animateDelay&&(Ee.Ea=e.animateDelay),void 0!==e.NNCpath&&(Ee.Cb=e.NNCpath),void 0!==e.NNC&&(Ee.ma=e.NNC),void 0!==e.maxFacesDetected&&(Me.i=Math.max(1,e.maxFacesDetected)),void 0!==e.followZRot&&(Ee.ia=!!e.followZRot),Me.i>ve.Ed)return C("MAXFACES_TOOHIGH"),!1;if(!e.canvasId&&!e.canvas)return C("NO_CANVASID"),!1;if(Ee.W=e.canvas?e.canvas:document.getElementById(e.canvasId),!Ee.W)return C("INVALID_CANVASID"),!1;if(De.N=Ee.W.width,De.P=Ee.W.height,!De.N||!De.P)return C("INVALID_CANVASDIMENSIONS"),!1;for(var n=0;n<Me.i;++n)Be.push(new Float32Array(ve.Fd)),Ce.push(0);Te=Object.create(ve.Ld),e.scanSettings&&(Object.assign(Te,e.scanSettings),-1!==Te.nDetectsPerLoop&&(Oe.G=Te.nDetectsPerLoop,Oe.qb=Te.nDetectsPerLoop)),ye=Object.create(ve.Wd),e.stabilizationSettings&&Object.assign(ye,e.stabilizationSettings);var i=0;return e.videoSettings&&e.videoSettings.videoElement?O(e.videoSettings.videoElement,r):(e.videoSettings&&Object.assign(de,e.videoSettings),B(e.onWebcamAsk,e.onWebcamGet,(function(e){O(e,r)}))),function(e){if(Ee.ma)w("string"==typeof Ee.ma?JSON.parse(Ee.ma):Ee.ma,e);else{var t=Ee.Cb;"JSON"!==t.toUpperCase().split(".").pop()&&(t+=ve.save),H.get(t,(function(t){w(t=JSON.parse(t),e)}))}}((function(e){if(!(V.o({Wa:Ee.W,width:De.N,height:De.P,debug:!1,pc:function(){C("GLCONTEXT_LOST")},antialias:!0,premultipliedAlpha:!0})&&V.ud()||(C("GL_INCOMPATIBLE"),0)))return!1;(Re=new t({})).Nd(e.layers),Re.Pd({qc:"gpuRawAvg",Hd:P}),Y.Fc([{id:"s48",name:"_",fa:"attribute vec2 a0;uniform mat2 u32;varying vec2 vv0;void main(){gl_Position=vec4(a0,0.,1.),vv0=vec2(.5,.5)+u32*a0*vec2(1.,-1.);}",Fa:["a0"],na:[2],a:"uniform sampler2D u1;varying vec2 vv0;void main(){gl_FragColor=texture2D(u1,vv0);}",c:["u1","u32"],precision:"lowp"},{id:"s49",name:"_",a:"uniform sampler2D u1;varying vec2 vv0;void main(){gl_FragColor=texture2D(u1,vv0);}",fa:"attribute vec2 a0;uniform sampler2D u33;uniform vec2 u34;uniform float u35,u36,u37;varying vec2 vv0;void main(){vec4 a=texture2D(u33,vec2(.17,u35));vec2 f=a.gb,g=a.a*u34,b=a0;b.x*=u37;float c=cos(u36),d=sin(u36);vec2 h=mat2(c,d,-d,c)*b;vv0=f+h*.5*g,gl_Position=vec4(a0,0.,1.);}",Fa:["a0"],na:[2],c:"u1 u33 u34 u35 u36 u37".split(" "),precision:"lowp"},{id:"s50",name:"_",a:"uniform sampler2D u38,u33;uniform vec3 u39,u40;uniform float u41,u42,u43,u35,u44,u36,u45;const vec4 e=vec4(.25,.25,.25,.25);void main(){vec4 f=texture2D(u38,vec2(.625,.625)),g=texture2D(u38,vec2(.875,.625)),a=texture2D(u33,vec2(.17,u35));float b=dot(f,e),h=dot(g,e);bool i=b>u42&&b>h+u43;i?a.r=2.:a.r>u41?a.r=0.:a.r>1.9?a.r+=1.:0.,a.r*=u44;if(a.r<.9)a=vec4(1.,u39);else{a.r*=step(1.9,a.r);float j=dot(e,texture2D(u38,vec2(.875,.875))),k=dot(e,texture2D(u38,vec2(.125,.625))),l=dot(e,texture2D(u38,vec2(.375,.625))),c=cos(u36),d=sin(u36);vec2 m=mat2(c,d*u45,-d/u45,c)*vec2(j,k);a.gba+=vec3(m,l)*u40*a.a;}gl_FragColor=a;}",fa:"attribute vec2 a0;void main(){gl_Position=vec4(a0,0.,1.);}",c:"u38 u33 u39 u41 u40 u44 u36 u45 u42 u43 u35".split(" ")},{id:"s51",name:"_",fa:"attribute vec2 a0;void main(){gl_Position=vec4(a0,0.,1.);}",a:"uniform sampler2D u38;const vec4 e=vec4(.25,.25,.25,.25);const vec3 f=vec3(.5,.5,.5);void main(){float a=dot(e,texture2D(u38,vec2(.125,.875))),b=dot(e,texture2D(u38,vec2(.375,.875))),c=dot(e,texture2D(u38,vec2(.625,.875))),d=dot(e,texture2D(u38,vec2(.625,.625)));vec3 g=vec3(a,b,c)*.5+f;gl_FragColor=vec4(g,d);}",c:["u38"]},{id:"s52",name:"_",fa:"attribute vec2 a0;void main(){gl_Position=vec4(a0,0.,1.);}",a:"uniform sampler2D u38;const vec4 e=vec4(.25,.25,.25,.25);void main(){float a=dot(e,texture2D(u38,vec2(.375,.375))),b=dot(e,texture2D(u38,vec2(.625,.375))),c=dot(e,texture2D(u38,vec2(.875,.375))),d=dot(e,texture2D(u38,vec2(.125,.125)));gl_FragColor=vec4(a,b,c,d);}",c:["u38"]},{id:"s47",name:"_",a:"uniform sampler2D u33;uniform vec2 u46;uniform float u47;varying vec2 vv0;void main(){float f=step(.5,mod(gl_FragCoord.y+1.5,2.)),c=step(.33,vv0.x);vec4 a=texture2D(u33,vv0+u46);a.a=mix(a.a*u47,a.a,c);vec4 d=floor(255.*a),g=255.*(255.*a-d),b=mix(d,g,f)/255.;b.x=mix(step(a.x,1.5),b.x,c),gl_FragColor=b;}",c:["u33","u47","u46"]}]),_(),function(){function e(e){for(var t=[],r=0;r<Me.i;++r)t.push(JSON.parse(JSON.stringify(e)));return t}Se.buffer=new Uint8Array(8*ve.wc*Me.i),Pe=e({Ha:0,x:0,y:0,U:1,vb:0,wb:0,xa:0,Rb:new Float32Array(Se.S),Pa:0}),Ue=e({detected:0,x:0,y:0,s:1,xRaw:0,yRaw:0,sRaw:1,rx:0,ry:0,rz:0,expressions:new Float32Array(Se.S)}),e({bb:0,cb:0,ab:0,Ya:0,Za:0,$a:0})}(),A(),x(),r()})),!0},destroy:function(){return new Promise((function(e,t){Ne.toggle_pause(!0,!0).catch((function(){t()})).then((function(){Re&&Re.h(),V.h(),Re=Ue=Pe=null,Be.splice(0),Ce.splice(0),me=he.rb,e()}))}))},toggle_pause:function(e,t){if(!g())return Promise.reject();var r=null;return r=t?le.zc(ge.element,!e,ge.ra):Promise.resolve(),e?b():r.then((function(){E()})),r},update_videoSettings:function(e){return b(),new Promise((function(t){le.zc(ge.element,!1,ge.ra).then((function(){Object.assign(de,e),B(null,null,(function(e){O(e,(function(){L(),I(),E(),t()}))}))}))}))},toggle_slow:function(e){g()&&me===he.play&&(e&&!Ee.Ka?(Ee.sc=Ee.Ea,Te.nDetectsPerLoop=1,this.set_animateDelay(100),Ee.Ka=!0):!e&&Ee.Ka&&(Te.nDetectsPerLoop=-1,this.set_animateDelay(Ee.sc),Ee.Ka=!1))},set_animateDelay:function(e){Ee.Ea=e},resize:function(){var e=Ee.W.width,t=Ee.W.height;return!(!M()&&e===De.N&&t===De.P||(De.N=e,De.P=t,A(),x(),L(),I(),ge.Y&&ge.Y.resize(De.N,De.P),0))},set_inputTexture:function(e,t,r){ge.u[0]=t,ge.u[1]=r,ge.nb=!0,L(),T(),I(),Y.set("s48"),ge.Y.M(),k.activeTexture(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,e),$.g(!0,!0)},reset_GLState:function(){T(),De.va.remove(),Se.Aa.remove(),_()},reset_inputTexture:function(){M(),ge.nb=!1,L(),I()},get_videoDevices:function(e){return le.qd(e)},set_scanSettings:function(e){Object.assign(Te,e),-1!==Te.nDetectsPerLoop&&(Oe.G=Te.nDetectsPerLoop,Oe.qb=Te.nDetectsPerLoop),A(),x()},set_stabilizationSettings:function(e){Object.assign(ye,e)},set_videoOrientation:function(e,t){g()&&(de.flipX=t,de.rotate=e,L(),I())},update_videoElement:function(e,t){O(e||ge.element,(function(){U(),L(),I(),t&&t()}))}};return Ne},window.JEEFACEFILTERAPI=window.JEEFACEFILTERAPIGEN(),JEEFACEFILTERAPI||window.JEEFACEFILTERAPI}).call(this,r(1).Buffer)},function(e,t,r){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var n=r(3),i=r(4),a=r(5);function o(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function u(e,t){if(o()<t)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=c.prototype:(null===e&&(e=new c(t)),e.length=t),e}function c(e,t,r){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return l(this,e)}return s(this,e,t,r)}function s(e,t,r,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,r,n){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n);c.TYPED_ARRAY_SUPPORT?(e=t).__proto__=c.prototype:e=v(e,t);return e}(e,t,r,n):"string"==typeof t?function(e,t,r){"string"==typeof r&&""!==r||(r="utf8");if(!c.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|h(t,r),i=(e=u(e,n)).write(t,r);i!==n&&(e=e.slice(0,i));return e}(e,t,r):function(e,t){if(c.isBuffer(t)){var r=0|d(t.length);return 0===(e=u(e,r)).length||t.copy(e,0,0,r),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(n=t.length)!=n?u(e,0):v(e,t);if("Buffer"===t.type&&a(t.data))return v(e,t.data)}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function f(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function l(e,t){if(f(t),e=u(e,t<0?0:0|d(t)),!c.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function v(e,t){var r=t.length<0?0:0|d(t.length);e=u(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function d(e){if(e>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|e}function h(e,t){if(c.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return H(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return X(e).length;default:if(n)return H(e).length;t=(""+t).toLowerCase(),n=!0}}function m(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return S(this,t,r);case"utf8":case"utf-8":return w(this,t,r);case"ascii":return D(this,t,r);case"latin1":case"binary":return F(this,t,r);case"base64":return A(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function g(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function p(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=c.from(t,n)),c.isBuffer(t))return 0===t.length?-1:E(e,t,r,n,i);if("number"==typeof t)return t&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):E(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function E(e,t,r,n,i){var a,o=1,u=e.length,c=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;o=2,u/=2,c/=2,r/=2}function s(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(i){var f=-1;for(a=r;a<u;a++)if(s(e,a)===s(t,-1===f?0:a-f)){if(-1===f&&(f=a),a-f+1===c)return f*o}else-1!==f&&(a-=a-f),f=-1}else for(r+c>u&&(r=u-c),a=r;a>=0;a--){for(var l=!0,v=0;v<c;v++)if(s(e,a+v)!==s(t,v)){l=!1;break}if(l)return a}return-1}function b(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var a=t.length;if(a%2!=0)throw new TypeError("Invalid hex string");n>a/2&&(n=a/2);for(var o=0;o<n;++o){var u=parseInt(t.substr(2*o,2),16);if(isNaN(u))return o;e[r+o]=u}return o}function R(e,t,r,n){return z(H(t,e.length-r),e,r,n)}function T(e,t,r,n){return z(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function y(e,t,r,n){return T(e,t,r,n)}function _(e,t,r,n){return z(X(t),e,r,n)}function x(e,t,r,n){return z(function(e,t){for(var r,n,i,a=[],o=0;o<e.length&&!((t-=2)<0);++o)r=e.charCodeAt(o),n=r>>8,i=r%256,a.push(i),a.push(n);return a}(t,e.length-r),e,r,n)}function A(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function w(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var a,o,u,c,s=e[i],f=null,l=s>239?4:s>223?3:s>191?2:1;if(i+l<=r)switch(l){case 1:s<128&&(f=s);break;case 2:128==(192&(a=e[i+1]))&&(c=(31&s)<<6|63&a)>127&&(f=c);break;case 3:a=e[i+1],o=e[i+2],128==(192&a)&&128==(192&o)&&(c=(15&s)<<12|(63&a)<<6|63&o)>2047&&(c<55296||c>57343)&&(f=c);break;case 4:a=e[i+1],o=e[i+2],u=e[i+3],128==(192&a)&&128==(192&o)&&128==(192&u)&&(c=(15&s)<<18|(63&a)<<12|(63&o)<<6|63&u)>65535&&c<1114112&&(f=c)}null===f?(f=65533,l=1):f>65535&&(f-=65536,n.push(f>>>10&1023|55296),f=56320|1023&f),n.push(f),i+=l}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=4096));return r}(n)}t.Buffer=c,t.SlowBuffer=function(e){+e!=e&&(e=0);return c.alloc(+e)},t.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=o(),c.poolSize=8192,c._augment=function(e){return e.__proto__=c.prototype,e},c.from=function(e,t,r){return s(null,e,t,r)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(e,t,r){return function(e,t,r,n){return f(t),t<=0?u(e,t):void 0!==r?"string"==typeof n?u(e,t).fill(r,n):u(e,t).fill(r):u(e,t)}(null,e,t,r)},c.allocUnsafe=function(e){return l(null,e)},c.allocUnsafeSlow=function(e){return l(null,e)},c.isBuffer=function(e){return!(null==e||!e._isBuffer)},c.compare=function(e,t){if(!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,n=t.length,i=0,a=Math.min(r,n);i<a;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!a(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=c.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var o=e[r];if(!c.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,i),i+=o.length}return n},c.byteLength=h,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},c.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?w(this,0,e):m.apply(this,arguments)},c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(e+=" ... ")),"<Buffer "+e+">"},c.prototype.compare=function(e,t,r,n,i){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;for(var a=(i>>>=0)-(n>>>=0),o=(r>>>=0)-(t>>>=0),u=Math.min(a,o),s=this.slice(n,i),f=e.slice(t,r),l=0;l<u;++l)if(s[l]!==f[l]){a=s[l],o=f[l];break}return a<o?-1:o<a?1:0},c.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},c.prototype.indexOf=function(e,t,r){return p(this,e,t,r,!0)},c.prototype.lastIndexOf=function(e,t,r){return p(this,e,t,r,!1)},c.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var a=!1;;)switch(n){case"hex":return b(this,e,t,r);case"utf8":case"utf-8":return R(this,e,t,r);case"ascii":return T(this,e,t,r);case"latin1":case"binary":return y(this,e,t,r);case"base64":return _(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,e,t,r);default:if(a)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),a=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function D(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function F(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function S(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",a=t;a<r;++a)i+=G(e[a]);return i}function P(e,t,r){for(var n=e.slice(t,r),i="",a=0;a<n.length;a+=2)i+=String.fromCharCode(n[a]+256*n[a+1]);return i}function U(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function I(e,t,r,n,i,a){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<a)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function L(e,t,r,n){t<0&&(t=65535+t+1);for(var i=0,a=Math.min(e.length-r,2);i<a;++i)e[r+i]=(t&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function M(e,t,r,n){t<0&&(t=4294967295+t+1);for(var i=0,a=Math.min(e.length-r,4);i<a;++i)e[r+i]=t>>>8*(n?i:3-i)&255}function O(e,t,r,n,i,a){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function B(e,t,r,n,a){return a||O(e,0,r,4),i.write(e,t,r,n,23,4),r+4}function C(e,t,r,n,a){return a||O(e,0,r,8),i.write(e,t,r,n,52,8),r+8}c.prototype.slice=function(e,t){var r,n=this.length;if((e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e),c.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=c.prototype;else{var i=t-e;r=new c(i,void 0);for(var a=0;a<i;++a)r[a]=this[a+e]}return r},c.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||U(e,t,this.length);for(var n=this[e],i=1,a=0;++a<t&&(i*=256);)n+=this[e+a]*i;return n},c.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||U(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},c.prototype.readUInt8=function(e,t){return t||U(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return t||U(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return t||U(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return t||U(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return t||U(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||U(e,t,this.length);for(var n=this[e],i=1,a=0;++a<t&&(i*=256);)n+=this[e+a]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},c.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||U(e,t,this.length);for(var n=t,i=1,a=this[e+--n];n>0&&(i*=256);)a+=this[e+--n]*i;return a>=(i*=128)&&(a-=Math.pow(2,8*t)),a},c.prototype.readInt8=function(e,t){return t||U(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){t||U(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt16BE=function(e,t){t||U(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt32LE=function(e,t){return t||U(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return t||U(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return t||U(e,4,this.length),i.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return t||U(e,4,this.length),i.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return t||U(e,8,this.length),i.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return t||U(e,8,this.length),i.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||I(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,a=0;for(this[t]=255&e;++a<r&&(i*=256);)this[t+a]=e/i&255;return t+r},c.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||I(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,a=1;for(this[t+i]=255&e;--i>=0&&(a*=256);)this[t+i]=e/a&255;return t+r},c.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||I(this,e,t,1,255,0),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||I(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):L(this,e,t,!0),t+2},c.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||I(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):L(this,e,t,!1),t+2},c.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||I(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):M(this,e,t,!0),t+4},c.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||I(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):M(this,e,t,!1),t+4},c.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);I(this,e,t,r,i-1,-i)}var a=0,o=1,u=0;for(this[t]=255&e;++a<r&&(o*=256);)e<0&&0===u&&0!==this[t+a-1]&&(u=1),this[t+a]=(e/o>>0)-u&255;return t+r},c.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);I(this,e,t,r,i-1,-i)}var a=r-1,o=1,u=0;for(this[t+a]=255&e;--a>=0&&(o*=256);)e<0&&0===u&&0!==this[t+a+1]&&(u=1),this[t+a]=(e/o>>0)-u&255;return t+r},c.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||I(this,e,t,1,127,-128),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||I(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):L(this,e,t,!0),t+2},c.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||I(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):L(this,e,t,!1),t+2},c.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||I(this,e,t,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):M(this,e,t,!0),t+4},c.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||I(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):M(this,e,t,!1),t+4},c.prototype.writeFloatLE=function(e,t,r){return B(this,e,t,!0,r)},c.prototype.writeFloatBE=function(e,t,r){return B(this,e,t,!1,r)},c.prototype.writeDoubleLE=function(e,t,r){return C(this,e,t,!0,r)},c.prototype.writeDoubleBE=function(e,t,r){return C(this,e,t,!1,r)},c.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i,a=n-r;if(this===e&&r<t&&t<n)for(i=a-1;i>=0;--i)e[i+t]=this[i+r];else if(a<1e3||!c.TYPED_ARRAY_SUPPORT)for(i=0;i<a;++i)e[i+t]=this[i+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+a),t);return a},c.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!c.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var a;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(a=t;a<r;++a)this[a]=e;else{var o=c.isBuffer(e)?e:H(new c(e,n).toString()),u=o.length;for(a=0;a<r-t;++a)this[a+t]=o[a%u]}return this};var N=/[^+\/0-9A-Za-z-_]/g;function G(e){return e<16?"0"+e.toString(16):e.toString(16)}function H(e,t){var r;t=t||1/0;for(var n=e.length,i=null,a=[],o=0;o<n;++o){if((r=e.charCodeAt(o))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(o+1===n){(t-=3)>-1&&a.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&a.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&a.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;a.push(r)}else if(r<2048){if((t-=2)<0)break;a.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;a.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return a}function X(e){return n.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(N,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function z(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}}).call(this,r(2))},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";t.byteLength=function(e){var t=s(e),r=t[0],n=t[1];return 3*(r+n)/4-n},t.toByteArray=function(e){var t,r,n=s(e),o=n[0],u=n[1],c=new a(function(e,t,r){return 3*(t+r)/4-r}(0,o,u)),f=0,l=u>0?o-4:o;for(r=0;r<l;r+=4)t=i[e.charCodeAt(r)]<<18|i[e.charCodeAt(r+1)]<<12|i[e.charCodeAt(r+2)]<<6|i[e.charCodeAt(r+3)],c[f++]=t>>16&255,c[f++]=t>>8&255,c[f++]=255&t;2===u&&(t=i[e.charCodeAt(r)]<<2|i[e.charCodeAt(r+1)]>>4,c[f++]=255&t);1===u&&(t=i[e.charCodeAt(r)]<<10|i[e.charCodeAt(r+1)]<<4|i[e.charCodeAt(r+2)]>>2,c[f++]=t>>8&255,c[f++]=255&t);return c},t.fromByteArray=function(e){for(var t,r=e.length,i=r%3,a=[],o=0,u=r-i;o<u;o+=16383)a.push(f(e,o,o+16383>u?u:o+16383));1===i?(t=e[r-1],a.push(n[t>>2]+n[t<<4&63]+"==")):2===i&&(t=(e[r-2]<<8)+e[r-1],a.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return a.join("")};for(var n=[],i=[],a="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u=0,c=o.length;u<c;++u)n[u]=o[u],i[o.charCodeAt(u)]=u;function s(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function f(e,t,r){for(var i,a,o=[],u=t;u<r;u+=3)i=(e[u]<<16&16711680)+(e[u+1]<<8&65280)+(255&e[u+2]),o.push(n[(a=i)>>18&63]+n[a>>12&63]+n[a>>6&63]+n[63&a]);return o.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,r,n,i){var a,o,u=8*i-n-1,c=(1<<u)-1,s=c>>1,f=-7,l=r?i-1:0,v=r?-1:1,d=e[t+l];for(l+=v,a=d&(1<<-f)-1,d>>=-f,f+=u;f>0;a=256*a+e[t+l],l+=v,f-=8);for(o=a&(1<<-f)-1,a>>=-f,f+=n;f>0;o=256*o+e[t+l],l+=v,f-=8);if(0===a)a=1-s;else{if(a===c)return o?NaN:1/0*(d?-1:1);o+=Math.pow(2,n),a-=s}return(d?-1:1)*o*Math.pow(2,a-n)},t.write=function(e,t,r,n,i,a){var o,u,c,s=8*a-i-1,f=(1<<s)-1,l=f>>1,v=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:a-1,h=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(u=isNaN(t)?1:0,o=f):(o=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-o))<1&&(o--,c*=2),(t+=o+l>=1?v/c:v*Math.pow(2,1-l))*c>=2&&(o++,c/=2),o+l>=f?(u=0,o=f):o+l>=1?(u=(t*c-1)*Math.pow(2,i),o+=l):(u=t*Math.pow(2,l-1)*Math.pow(2,i),o=0));i>=8;e[r+d]=255&u,d+=h,u/=256,i-=8);for(o=o<<i|u,s+=i;s>0;e[r+d]=255&o,d+=h,o/=256,s-=8);e[r+d-h]|=128*m}},function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},function(e,t,r){"use strict";r.r(t),r.d(t,"Helpers",(function(){return n}));var n={};r.r(n),r.d(n,"DrageEvent",(function(){return a})),r.d(n,"HeadControls",(function(){return o})),r.d(n,"JeelizCanvas2DHelper",(function(){return u})),r.d(n,"JeelizFaceCut",(function(){return c})),r.d(n,"JeelizResizer",(function(){return s})),r.d(n,"JeelizThreejsHelper",(function(){return f}));var i=r(0);const a=()=>{try{new window.THREE.Vector3}catch(e){throw new Error("Three JS lib not loaded into scope")}new window.THREE.Vector3},o=function(){const e={detectionThreshold:.85,detectionHysteresis:.05,tol:{rx:5,ry:5,s:5},sensibility:{rx:1,ry:1,s:1}};let t=null;const r={dRx:0,dRy:0,dZ:0},n={isLoaded:!1,isDetected:!1,isEnabled:!1,restHeadPosition:{needsUpdate:!1,s:0,rx:0,ry:0}};let i=0,a=null,o=null,u=null,c=null,s=null,f=!1;function l(e,t,r,n){return Math.abs(e-t)<r?0:(t-e)*n}function v(e,t,r){const n=a.createShader(t);return a.shaderSource(n,e),a.compileShader(n),a.getShaderParameter(n,a.COMPILE_STATUS)?n:(alert("ERROR IN "+r+" SHADER: "+a.getShaderInfoLog(n)),!1)}function d(e){if(n.isDetected&&e.detected<t.detectionThreshold-t.detectionHysteresis?(n.isDetected=!1,r.dRx=0,r.dRy=0,r.dZ=0):!n.isDetected&&e.detected>t.detectionThreshold+t.detectionHysteresis&&(n.isDetected=!0),n.isEnabled&&function(e){a.viewport(0,0,o.width,o.height),a.useProgram(c),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,u),a.uniform3f(s,e.x,e.y,e.s),a.drawElements(a.TRIANGLES,3,a.UNSIGNED_SHORT,0)}(e),!n.isEnabled||!n.isDetected||!n.isLoaded)return r;n.restHeadPosition.needsUpdate&&!f&&(n.restHeadPosition.needsUpdate=!1,n.restHeadPosition.rx=e.rx,n.restHeadPosition.ry=e.ry,n.restHeadPosition.s=e.s,i=Date.now());const v=Date.now(),d=v-i;return r.dRx=d*l(n.restHeadPosition.rx,e.rx,t.tol.rx,t.sensibility.rx),r.dRy=d*l(n.restHeadPosition.ry,e.ry,t.tol.ry,t.sensibility.ry),r.dZ=d*l(n.restHeadPosition.s,e.s,t.tol.s,t.sensibility.s),i=v,r}return{init:function(r){void 0===r.settings&&(r.settings={}),f=void 0!==r.disableRestPosition&&r.disableRestPosition,t=Object.assign({},e,r.settings),t.tol.rx*=Math.PI/180,t.tol.ry*=Math.PI/180,t.tol.s/=100,JEEFACEFILTERAPI.init({canvasId:r.canvasId,NNCpath:r.NNCpath,callbackReady:function(e,t){if(e)return console.log("AN ERROR HAPPENS. SORRY BRO :( . ERR =",e),void(r.callbackReady&&r.callbackReady(e));a=t.GL,u=t.videoTexture,o=t.canvasElement,function(){const e=v("\n      attribute vec2 aat_position;\n      varying vec2 vUV;\n      \n      void main(void) {\n        gl_Position = vec4(aat_position, 0., 1.);\n        vUV = (aat_position*0.5) + vec2(0.5,0.5);\n        vUV.x = 1.-vUV.x; // mirror diplay\n      }",a.VERTEX_SHADER,"VERTEX"),t=v("\n      precision lowp float;\n      varying vec2 vUV;\n      uniform sampler2D samplerVideo;\n      uniform vec3 uxys;\n      \n      void main(void) {\n        vec3 colorVideo = texture2D(samplerVideo, vUV).rgb;\n        vec2 pos = vUV*2.-vec2(1.,1.);\n        vec2 isInside = step(uxys.xy-uxys.z*vec2(1.,1.), pos);\n        isInside *= step(pos, uxys.xy+uxys.z*vec2(1.,1.));\n        vec2 blendCenterFactor = abs(pos-uxys.xy) / uxys.z;\n        float alpha = isInside.x * isInside.y * pow(max(blendCenterFactor.x, blendCenterFactor.y), 3.);\n        vec3 color = mix(colorVideo, vec3(0.,0.6,1.), alpha);\n        gl_FragColor = vec4(color,1.);\n      }",a.FRAGMENT_SHADER,"FRAGMENT");c=a.createProgram(),a.attachShader(c,e),a.attachShader(c,t),a.linkProgram(c);const r=a.getUniformLocation(c,"samplerVideo");s=a.getUniformLocation(c,"uxys"),a.useProgram(c),a.uniform1i(r,0)}(),r.callbackReady&&r.callbackReady(!1),n.isLoaded=!0},callbackTrack:function(e){const t=d(e);t.expressions=e.expressions,n.isEnabled&&(0===t.dRx&&0===t.dRy&&0===t.dZ||r.callbackMove(t))}})},toggle:function(e){return n.isEnabled===e||(e?(n.isEnabled=!0,n.restHeadPosition.needsUpdate=!0,!0):(n.isEnabled=!1,!0))},reset_restHeadPosition:function(){n.restHeadPosition.needsUpdate=!0}}}(),u=function(e){let t=null,r=null,n=null,i=null,a=null,o=null,u=null,c=null;const s={x:0,y:0,s:0};function f(e,t,r){const n=i.createShader(t);return i.shaderSource(n,e),i.compileShader(n),i.getShaderParameter(n,i.COMPILE_STATUS)||alert("ERROR IN "+r+" SHADER: "+i.getShaderInfoLog(n)),n}i=e.GL,t=e.canvasElement,c=e.videoTexture,r=document.createElement("canvas"),r.width=t.width,r.height=t.height,n=r.getContext("2d"),a=i.createTexture(),i.bindTexture(i.TEXTURE_2D,a),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,r),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE);u=function(e,t,r){const n=f(e,i.VERTEX_SHADER,"VERTEX "+r),a=f(t,i.FRAGMENT_SHADER,"FRAGMENT "+r),o=i.createProgram();return i.attachShader(o,n),i.attachShader(o,a),i.linkProgram(o),o}("attribute vec2 position;\n     varying vec2 vUV;\n     void main(void){\n      gl_Position = vec4(position, 0., 1.);\n      vUV = vec2(0.5,0.5) + 0.5*position;\n     }","precision lowp float;\n     uniform sampler2D samplerImage;\n     varying vec2 vUV;\n     \n     void main(void){\n      gl_FragColor = texture2D(samplerImage, vUV);\n     }","VIDEO");const l=i.getUniformLocation(u,"samplerImage");return i.useProgram(u),i.uniform1i(l,0),{canvas:r,ctx:n,update_canvasTexture:function(){o=!0},draw:function(){i.viewport(0,0,t.width,t.height),i.useProgram(u),i.enable(i.BLEND),i.blendFunc(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA),i.bindTexture(i.TEXTURE_2D,c),i.drawElements(i.TRIANGLES,3,i.UNSIGNED_SHORT,0),i.bindTexture(i.TEXTURE_2D,a),o&&i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,r),i.drawElements(i.TRIANGLES,3,i.UNSIGNED_SHORT,0),i.disable(i.BLEND)},getCoordinates:function(e){return s.x=Math.round((.5+.5*e.x-.5*e.s)*t.width),s.y=Math.round((.5+.5*e.y-.5*e.s)*t.height),s.w=Math.round(e.s*t.width),s.h=s.w,s},resize:function(){r.width=t.width,r.height=t.height}}},c=function(){const e={scale:[1.1,1.7],offset:[.01,.1],smoothEdge:.15,headForheadY:.7,headJawY:.5,ryDriftDx:-.1,rzDriftDx:.1};let t=null,r=null,n=null,i={},a=null,o=null;function u(e,r,n){const i=t.createShader(r);return t.shaderSource(i,e),t.compileShader(i),t.getShaderParameter(i,t.COMPILE_STATUS)?i:(alert("ERROR IN "+n+" SHADER: "+t.getShaderInfoLog(i)),console.log("Buggy shader source: \n",e),!1)}function c(e,r,n){const i=u(e,t.VERTEX_SHADER,"VERTEX "+n),a=u(r,t.FRAGMENT_SHADER,"FRAGMENT "+n),o=t.createProgram();t.attachShader(o,i),t.attachShader(o,a),t.linkProgram(o);const c=t.getAttribLocation(o,"position");return t.enableVertexAttribArray(c),{program:o,uniforms:{}}}function s(){t.drawElements(t.TRIANGLES,3,t.UNSIGNED_SHORT,0)}function f(e,r){const n=t.createTexture();return t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e,r,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),n}const l={init:function(u){t=u.GL,r=u.canvasElement,n=u.videoTexture,function(){const r="attribute vec2 position;\n       varying vec2 vUV;\n       void main(void){\n        gl_Position = vec4(position, 0., 1.);\n        vUV = 0.5 + 0.5*position;\n       }";i.copy=c(r,"precision lowp float;\n       uniform sampler2D samplerImage;\n       varying vec2 vUV;\n       \n       void main(void){\n         gl_FragColor = texture2D(samplerImage, vUV);\n       }","COPY"),i.copy.uniforms.samplerImage=t.getUniformLocation(i.copy.program,"samplerImage"),t.useProgram(i.copy.program),t.uniform1i(i.copy.uniforms.samplerImage,0),i.search=c(r,"precision lowp float;\n       uniform float detected;\n       varying vec2 vUV;\n       \n       void main(void){\n         vec3 color = mix(vec3(0.1,0.1,0.1), vec3(0.,0.6,1.), detected);\n         vec2 blendCenterFactor = 2. * abs(vUV-vec2(0.5,0.5));\n         float alpha = pow(max(blendCenterFactor.x, blendCenterFactor.y), 3.);\n         gl_FragColor = vec4(color, alpha*0.5);\n       }","SEARCH"),i.search.uniforms.detected=t.getUniformLocation(i.search.program,"detected");const n="attribute vec2 position;\n     uniform float rz, aspectRatio;\n     varying vec2 vUV, vUVrot;\n     void main(void){\n       float cz=cos(rz+0.2),sz=sin(rz);\n       vec2 posRz=mat2(cz, sz*aspectRatio, -sz/aspectRatio, cz)*position;\n      gl_Position=vec4(position, 0., 1.);\n      vUV=0.5+0.5*position;\n      vUVrot=0.5+0.5*posRz;\n     }",a="precision lowp float;\n     uniform vec2 offset, scale;\n     uniform sampler2D samplerImage;\n     varying vec2 vUV, vUVrot;\n     \n     const float UPPERHEADY = "+e.headForheadY.toFixed(2)+";\n     const float LOWERHEADY = "+e.headJawY.toFixed(2)+";\n     const float SMOOTHEDGE = "+e.smoothEdge.toFixed(2)+";\n     \n     \n     void main(void){\n       \n       float alpha = 0.;\n       vec2 uv = vUVrot; // uv normalized in the face\n       if (uv.y>UPPERHEADY){ // upper head: circle arc\n         vec2 uvc = (uv-vec2(0.5,UPPERHEADY))*vec2(1., 0.5/(1.-UPPERHEADY));\n         float alphaBorder = smoothstep(0.5-SMOOTHEDGE, 0.5, length(uvc));\n         float alphaCenter = smoothstep(UPPERHEADY, 1., uv.y);\n         alpha = mix(alphaCenter, alphaBorder, smoothstep(0.3, 0.45, abs(uv.x-0.5)));\n       } else if (uv.y<LOWERHEADY){ // lower head: circle arc \n         vec2 uvc = (uv-vec2(0.5, LOWERHEADY))*vec2(1., 0.5/LOWERHEADY);\n         alpha = smoothstep(0.5-SMOOTHEDGE, 0.5, length(uvc));\n       } else { // middle head: straight\n         vec2 uvc = vec2(uv.x-0.5, 0.);\n         alpha = smoothstep(0.5-SMOOTHEDGE, 0.5,length(uvc));\n       }\n       \n       vec2 uvCol = offset + (vUV+vec2(-0.5,-0.5))*scale;\n       vec3 color = texture2D(samplerImage, uvCol).rgb;\n       \n       float grayScale=dot(color, vec3(0.33,0.33,0.33));\n      if (alpha>0.01){\n        alpha=mix(pow(alpha, 0.5), pow(alpha, 1.5), smoothstep(0.1,0.5,grayScale));\n      }\n      //color=vec3(1.,0.,0.); //FOR DEBUG: DISPLAY IN RED\n      gl_FragColor=vec4(color, 1.-alpha);\n       \n     }";i.faceCut=c(n,a,"FACECUT"),i.faceCut.uniforms.rz=t.getUniformLocation(i.faceCut.program,"rz"),i.faceCut.uniforms.offset=t.getUniformLocation(i.faceCut.program,"offset"),i.faceCut.uniforms.scale=t.getUniformLocation(i.faceCut.program,"scale"),i.faceCut.uniforms.aspectRatio=t.getUniformLocation(i.faceCut.program,"aspectRatio"),i.faceCut.uniforms.samplerImage=t.getUniformLocation(i.faceCut.program,"samplerImage"),t.useProgram(i.faceCut.program),t.uniform1i(i.faceCut.uniforms.samplerImage,0),i.renderFace=c(n,"precision lowp float;\n     uniform sampler2D samplerImage, samplerHueSrc, samplerHueDst;\n     varying vec2 vUV, vUVrot;\n     const vec2 EPSILON2=vec2(0.001, 0.001);\n     \n     vec3 rgb2hsv(vec3 c) { //from http://lolengine.net/blog/2013/07/27/rgb-to-hsv-in-glsl\n      vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n      vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n      vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n      float d = q.x - min(q.w, q.y);\n      float e = 1.0e-10;\n      return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n     }\n     \n     vec3 hsv2rgb(vec3 c) { //from https://github.com/hughsk/glsl-hsv2rgb \n      vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0); \n      vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www); \n      return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y); \n      //return c.z * normalize(mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y));\n     } \n     \n     void main(void){\n       vec2 uv = vUVrot;\n       // get color in HSV format:\n       vec2 uvCut = uv;\n       vec4 colorImage = texture2D(samplerImage, uvCut);\n       vec3 colorRGB = colorImage.rgb;\n       vec3 colorHSV = rgb2hsv(colorRGB);\n       // compute color transform:\n       vec3 srcRGB = texture2D(samplerHueSrc, uv).rgb;\n       vec3 dstRGB = texture2D(samplerHueDst, uv).rgb;\n       vec3 srcHSV = rgb2hsv(srcRGB);\n       vec3 dstHSV = rgb2hsv(dstRGB);\n       // apply the transform:\n       vec2 factorSV = vec2(1.,0.8)*dstHSV.yz/(srcHSV.yz+EPSILON2);\n       factorSV = clamp(factorSV, vec2(0.3,0.3), vec2(3,3.));\n       float dHue = dstHSV.x - srcHSV.x;\n       vec3 colorHSVout = vec3(mod(1.0+colorHSV.x+dHue, 1.0), colorHSV.yz*factorSV);\n       colorHSVout = clamp(colorHSVout, vec3(0.,0.,0.), vec3(1.,1.,1));\n       // reconvert to RGB and output the color:\n       colorRGB = hsv2rgb(colorHSVout);\n       gl_FragColor = vec4(colorRGB, colorImage.a);\n     }","RENDERFACE"),i.renderFace.uniforms.rz=t.getUniformLocation(i.renderFace.program,"rz"),i.renderFace.uniforms.aspectRatio=t.getUniformLocation(i.renderFace.program,"aspectRatio"),i.renderFace.uniforms.samplerImage=t.getUniformLocation(i.renderFace.program,"samplerImage"),i.renderFace.uniforms.samplerHueSrc=t.getUniformLocation(i.renderFace.program,"samplerHueSrc"),i.renderFace.uniforms.samplerHueDst=t.getUniformLocation(i.renderFace.program,"samplerHueDst"),t.useProgram(i.renderFace.program),t.uniform1i(i.renderFace.uniforms.samplerImage,0),t.uniform1i(i.renderFace.uniforms.samplerHueSrc,2),t.uniform1i(i.renderFace.uniforms.samplerHueDst,1)}(),o=t.createFramebuffer(),a=t.DRAW_FRAMEBUFFER?t.DRAW_FRAMEBUFFER:t.FRAMEBUFFER},draw_video:function(){t.bindFramebuffer(a,null),t.useProgram(i.copy.program),t.bindTexture(t.TEXTURE_2D,n),t.viewport(0,0,r.width,r.height),s()},draw_search:function(e){l.draw_video(),t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),t.useProgram(i.search.program),e.forEach((function(e){t.uniform1f(i.search.uniforms.detected,e.detected);const n=.5*(e.x+1)*r.width,a=.5*(e.y+1)*r.height,o=Math.round(e.s*r.width);t.viewport(Math.round(n-o/2),Math.round(a-o/2),o,o),s()}))},instance:function(u){u.sizePx=u.sizePx||64,u.hueSizePx=u.hueSizePx||4;const c=function(e,r){const n=f(e,r);return t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_NEAREST),n}(u.sizePx,u.sizePx),l=function(e,r){const n=f(e,r);return t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),n}(u.hueSizePx,u.hueSizePx),v=[0,0],d=[0,0];let h=0;return{get_faceScale:function(){return d},get_faceOffset:function(){return v},get_rz:function(){return h},bind_hueTexture:function(){t.bindTexture(t.TEXTURE_2D,l)},cut:function(f){t.bindFramebuffer(a,o),t.disable(t.BLEND),function(t){h=t.rz,v[0]=.5*t.x+.5+t.s*e.offset[0]*Math.sin(t.ry),v[1]=.5*t.y+.5+t.s*e.offset[1],d[0]=t.s*e.scale[0],d[1]=t.s*e.scale[1]*r.width/r.height,v[0]+=d[0]*e.ryDriftDx*Math.sin(t.ry),v[0]+=d[0]*e.rzDriftDx*Math.sin(t.rz)}(f),t.useProgram(i.faceCut.program),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,c,0),t.viewport(0,0,u.sizePx,u.sizePx),t.uniform1f(i.faceCut.uniforms.rz,-h),t.uniform1f(i.faceCut.uniforms.aspectRatio,e.scale[0]/e.scale[1]),t.uniform2fv(i.faceCut.uniforms.offset,v),t.uniform2fv(i.faceCut.uniforms.scale,d),t.bindTexture(t.TEXTURE_2D,n),s(),t.useProgram(i.copy.program),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,l,0),t.viewport(0,0,u.hueSizePx,u.hueSizePx),t.bindTexture(t.TEXTURE_2D,c),t.generateMipmap(t.TEXTURE_2D),s()},render:function(n){t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);const a=n.get_faceScale(),o=n.get_faceOffset(),u=o[0]*r.width,f=o[1]*r.height,v=a[0]*r.width,d=a[1]*r.height;t.viewport(Math.round(u-v/2),Math.round(f-d/2),Math.round(v),Math.round(d)),t.useProgram(i.renderFace.program),t.uniform1f(i.renderFace.uniforms.rz,h-n.get_rz()),t.uniform1f(i.renderFace.uniforms.aspectRatio,e.scale[0]/e.scale[1]),t.activeTexture(t.TEXTURE2),t.bindTexture(t.TEXTURE_2D,l),t.activeTexture(t.TEXTURE1),n.bind_hueTexture(),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,c),s(),t.disable(t.BLEND)}}}};return l}(),s=function(){let e=null,t=null,r=!1,n=0,i=1,a=!1,o=null,u=null,c=!1;const s=[[640,480],[768,480],[800,600],[960,640],[960,720],[1024,768],[1280,720],[1920,1080]];function f(e,t){var r,n;e[0]/e[1]>t[0]/t[1]?(r=e,n=t):(r=t,n=e);const i=Math.min(r[0],n[0])*Math.min(r[1],n[1]);var a;return r[0]>=n[0]&&r[1]>=n[1]?a=r[0]*r[1]:n[0]>r[0]&&n[1]>r[1]?a=n[0]*n[1]:(a=r[0]*r[1],a+=(n[1]-r[1])*n[0]),i/a}function l(){const t=e.getBoundingClientRect();v(t.width,t.height)}function v(n,a){t=[Math.round(i*n),Math.round(i*a)],e.setAttribute("width",t[0]),e.setAttribute("height",t[1]),r&&(e.style.width=n.toString()+"px",e.style.height=a.toString()+"px")}function d(){o&&clearTimeout(o),o=setTimeout(m,50)}function h(){const e=[window.innerWidth,window.innerHeight];c&&e.reverse(),v(e[0],e[1])}function m(){h(),JEEFACEFILTERAPI.resize(),o=null,u&&u()}const g={is_portrait:function(){try{return!!window.matchMedia("(orientation: portrait)").matches}catch(e){return window.innerHeight>window.innerWidth}},check_isIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream},get_IOSVersion:function(){const e=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);return e.length>2?[parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3]||0,10)]:[0,0,0]},check_isAndroid:function(){return-1!==navigator.userAgent.toLowerCase().indexOf("android")},get_androidVersion:function(){const e=navigator.userAgent.toLowerCase().match(/android\s([0-9\.]*)/i);if(!e||e.length<2)return[0,0,0];const t=e[1].split(".");return[parseInt(t[0],10),parseInt(t[1],10),parseInt(t[2]||0,10)]},require_flipVideoWHIfPortrait:function(){return!1},size_canvas:function(o){const v=Object.assign({canvasId:"undefinedCanvasId",canvas:null,overSamplingFactor:window.devicePixelRatio||1,isFullScreen:!1,isInvWH:!1,CSSFlipX:!1,isApplyCSS:!1,onResize:null,callback:function(){}},o);if(e=v.canvas?v.canvas:document.getElementById(v.canvasId),a=v.isFullScreen,c=v.isInvWH,r=v.isApplyCSS,i=v.overSamplingFactor,a)u=v.onResize,h(),window.addEventListener("resize",d,!1),window.addEventListener("orientationchange",d,!1);else{const t=e.getBoundingClientRect();if(0===t.width||0===t.height)return console.log("WARNING in JeelizResize.size_canvas(): the canvas has its width or its height null, Retry a bit later..."),++n>20?void v.callback("CANNOT_RESIZECANVAS"):void setTimeout(g.size_canvas.bind(null,v),50);n=0,l()}v.CSSFlipX&&function(e,t){const r=e.style.transform;-1===r.indexOf(t)&&(e.style.transform=t+" "+r)}(e,"rotateY(180deg)");const m=s.map((function(e){return e.slice(0)}));g.is_portrait()&&g.require_flipVideoWHIfPortrait()&&m.forEach((function(e){e.reverse()})),m.sort((function(e,r){return f(r,t)-f(e,t)}));const p={idealWidth:m[0][0],idealHeight:m[0][1]};console.log("INFO in JeelizResizer: bestCameraResolution =",p),setTimeout(v.callback.bind(null,!1,p),1)},resize_canvas:function(){a?h():l()},get_canvasSize:function(){return t}};return g}(),f=function(){const e={rotationOffsetX:0,pivotOffsetYZ:[.2,.6],detectionThreshold:.8,detectionHysteresis:.02,cameraMinVideoDimFov:35,isDebugPivotPoint:!1};let t=null,r=null,n=null,i=null,a=-1,o=!1,u=null,c=!1,s=!1,f=null,l=null,v=!1,d=1,h=-1;const m=[],g=[];let p=null,E=null,b=null;function R(t){m.forEach((function(r,n){v=r.visible;const i=t[n];v&&i.detected<e.detectionThreshold-e.detectionHysteresis?(u&&u(n,!1),r.visible=!1):!v&&i.detected>e.detectionThreshold+e.detectionHysteresis&&(u&&u(n,!0),r.visible=!0)}))}const T={init:function(v,d){c=!1,m.splice(0),g.splice(0),i&&(i.dispose(),i=null),a=v.maxFacesDetected,E=v.videoTexture,p=v.GL,f=v.canvasElement,o=a>1,l=v.videoElement;let h=null;v.threejsCanvasId?(s=!0,h=document.getElementById(v.threejsCanvasId),h.setAttribute("width",f.width),h.setAttribute("height",f.height)):h=f,void 0!==d&&(u=d),t=new THREE.WebGLRenderer({context:s?null:p,canvas:h,alpha:!(!s&&!v.alpha)}),r=new THREE.Scene,function(){for(let t=0;t<a;++t){const t=new THREE.Object3D;t.frustumCulled=!1,t.visible=!1;const n=new THREE.Object3D;if(n.frustumCulled=!1,t.add(n),m.push(t),g.push(n),r.add(t),e.isDebugPivotPoint){const e=new THREE.Mesh(new THREE.BoxGeometry(.1,.1,.1),new THREE.MeshNormalMaterial({side:THREE.DoubleSide,depthTest:!1}));e.position.copy(n.position),t.add(e),window.pivot=e,console.log("DEBUG in JeelizThreeHelper: set the position of <pivot> in the console and report the value into JeelizThreejsHelper.js for _settings.pivotOffsetYZ")}}}(),function(){const e="attribute vec2 position;\n        varying vec2 vUV;\n        void main(void){\n          gl_Position = vec4(position, 0., 1.);\n          vUV = 0.5 + 0.5 * position;\n        }",t="precision lowp float;\n        uniform sampler2D samplerVideo;\n        varying vec2 vUV;\n        void main(void){\n          gl_FragColor = texture2D(samplerVideo, vUV);\n        }";if(s){const r=function(e,t,r){const n=p.createShader(t);return p.shaderSource(n,e),p.compileShader(n),p.getShaderParameter(n,p.COMPILE_STATUS)?n:(alert("ERROR IN "+r+" SHADER: "+p.getShaderInfoLog(n)),!1)},n=r(e,p.VERTEX_SHADER,"VERTEX"),i=r(t,p.FRAGMENT_SHADER,"FRAGMENT");b=p.createProgram(),p.attachShader(b,n),p.attachShader(b,i),p.linkProgram(b);p.getUniformLocation(b,"samplerVideo");return}i=new THREE.DataTexture(new Uint8Array([255,0,0]),1,1,THREE.RGBFormat),i.needsUpdate=!0;const a=new THREE.RawShaderMaterial({depthWrite:!1,depthTest:!1,vertexShader:e,fragmentShader:t,uniforms:{samplerVideo:{value:i}}}),o=new THREE.BufferGeometry,u=new Float32Array([-1,-1,1,-1,1,1,-1,1]);o.addAttribute("position",new THREE.BufferAttribute(u,2)),o.setIndex(new THREE.BufferAttribute(new Uint16Array([0,1,2,0,2,3]),1)),n=new THREE.Mesh(o,a),T.apply_videoTexture(n),n.renderOrder=-1e3,n.frustumCulled=!1,r.add(n)}(),window.addEventListener("orientationchange",(function(){setTimeout(JEEFACEFILTERAPI.resize,1e3)}),!1);const R={videoMesh:n,renderer:t,scene:r};return o?R.faceObjects=g:R.faceObject=g[0],R},detect:function(e){R(o?e:[e])},get_isDetected:function(){return v},render:function(n,i){const a=o?n:[n];R(a),function(t,r){const n=Math.tan(r.aspect*r.fov*Math.PI/360);m.forEach((function(r,i){if(!r.visible)return;const a=t[i],o=Math.cos(a.rz),u=Math.sin(a.rz),c=1/(2*(a.s*d)*n)+.5,s=a.x*d,f=a.y*d,l=-c,v=s*c*n,m=f*c*n/h;g[i].position.set(-u*e.pivotOffsetYZ[0],-o*e.pivotOffsetYZ[0],-e.pivotOffsetYZ[1]),r.position.set(v,m+e.pivotOffsetYZ[0],l+e.pivotOffsetYZ[1]),r.rotation.set(a.rx+e.rotationOffsetX,a.ry,a.rz,"ZYX")}))}(a,i),s?(p.viewport(0,0,f.width,f.height),p.useProgram(b),p.activeTexture(p.TEXTURE0),p.bindTexture(p.TEXTURE_2D,E),p.drawElements(p.TRIANGLES,3,p.UNSIGNED_SHORT,0)):t.state.reset(),t.render(r,i)},sortFaces:function(e,t,r){const n={X:0,Y:1,Z:2}[t.toUpperCase()],i=r?-1:1,a=e.index.count/3,o=new Array(a);for(let t=0;t<a;++t)o[t]=[e.index.array[3*t],e.index.array[3*t+1],e.index.array[3*t+2]];const u=e.attributes.position.array,c=o.map((function(e,t){return[(u[3*e[0]]+u[3*e[1]]+u[3*e[2]])/3,(u[3*e[0]+1]+u[3*e[1]+1]+u[3*e[2]+1])/3,(u[3*e[0]+2]+u[3*e[1]+2]+u[3*e[2]+2])/3,e]}));c.sort((function(e,t){return(e[n]-t[n])*i})),c.forEach((function(t,r){const n=t[3];e.index.array[3*r]=n[0],e.index.array[3*r+1]=n[1],e.index.array[3*r+2]=n[2]}))},get_threeVideoTexture:function(){return i},apply_videoTexture:function(e){c||(e.onAfterRender=function(){try{t.properties.update(i,"__webglTexture",E),i.magFilter=THREE.LinearFilter,i.minFilter=THREE.LinearFilter,c=!0}catch(e){console.log("WARNING in JeelizThreeHelper: the glVideoTexture is not fully initialized")}delete e.onAfterRender})},create_threejsOccluder:function(e,t){const r=new THREE.Mesh;return(new THREE.BufferGeometryLoader).load(e,(function(e){const n=new THREE.ShaderMaterial({vertexShader:THREE.ShaderLib.basic.vertexShader,fragmentShader:"precision lowp float;\n void main(void){\n gl_FragColor=vec4(1.,0.,0.,1.);\n }",uniforms:THREE.ShaderLib.basic.uniforms,colorWrite:!1});r.renderOrder=-1,r.material=n,r.geometry=e,void 0!==t&&t&&t(r)})),r},set_pivotOffsetYZ:function(t){e.pivotOffsetYZ=t},create_camera:function(e,t){const r=new THREE.PerspectiveCamera(1,1,e||.1,t||100);return T.update_camera(r),r},update_camera:function(r){const n=t.domElement,i=n.width,a=n.height;h=i/a;const o=l.videoWidth,u=l.videoHeight,c=o/u,s=u>o?1/c:1,f=e.cameraMinVideoDimFov*s;console.log("INFO in JeelizThreejsHelper - update_camera(): Estimated vertical video FoV is",f);let v=1;v=h>c?i/o:a/u;const m=o*v,g=u*v,p=(m-i)/2,E=(g-a)/2;d=i/m,r.aspect=h,r.fov=f,console.log("INFO in JeelizThreejsHelper.update_camera(): camera vertical estimated FoV is",f,"deg"),r.setViewOffset(m,g,p,E,i,a),r.updateProjectionMatrix(),t.setSize(i,a,!1),t.setViewport(0,0,i,a)},resize:function(e,r,n){t.domElement.width=e,t.domElement.height=r,JEEFACEFILTERAPI.resize(),n&&T.update_camera(n)}};return T}();t.default=i}]);